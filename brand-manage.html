<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Brand Management - FreshMart POS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    *{font-family:'Inter',sans-serif;box-sizing:border-box}
    body{background:#f8fafc;min-height:100vh}
    .card{background:#fff;border-radius:12px;box-shadow:0 1px 3px rgba(0,0,0,0.04),0 1px 2px rgba(0,0,0,0.06)}
    .input{background:#fff;border:1.5px solid #e2e8f0;border-radius:8px;transition:all 0.15s}
    .input:focus{outline:none;border-color:#10b981;box-shadow:0 0 0 3px rgba(16,185,129,0.1)}
    .btn-primary{background:#10b981;color:#fff;font-weight:500;transition:all 0.15s}
    .btn-primary:hover{background:#059669}
    .btn-secondary{background:#f1f5f9;color:#475569;font-weight:500;transition:all 0.15s}
    .btn-secondary:hover{background:#e2e8f0}
    ::-webkit-scrollbar{width:5px;height:5px}
    ::-webkit-scrollbar-track{background:#f1f5f9}
    ::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}
    .row-hover:hover{background:#f8fafc}
    .fade-in{animation:fadeIn 0.2s ease}
    @keyframes fadeIn{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}
    .tab-active{border-bottom:2px solid #10b981;color:#10b981}
    .logo-upload{border:2px dashed #e2e8f0;transition:all 0.15s}
    .logo-upload:hover{border-color:#10b981;background:#f0fdf4}
  </style>
</head>
<body class="text-slate-700">
  
  <!-- Header -->
  <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
    <div class="max-w-6xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <button onclick="window.history.back()" class="w-9 h-9 rounded-lg bg-slate-100 hover:bg-slate-200 flex items-center justify-center">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
          </button>
          <div>
            <h1 class="text-lg font-semibold text-slate-800">Brand Management</h1>
            <p class="text-xs text-slate-400">Manage product brands</p>
          </div>
        </div>
        <button onclick="openAddModal()" class="btn-primary px-4 py-2 rounded-lg text-sm flex items-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
          Add Brand
        </button>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-4">
    
    <!-- Stats -->
    <div class="grid grid-cols-4 gap-4 mb-5">
      <div class="card px-4 py-3 flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-emerald-50 flex items-center justify-center text-lg">üè∑Ô∏è</div>
        <div>
          <p class="text-xl font-bold text-slate-800" id="totalBrands">0</p>
          <p class="text-xs text-slate-400">Total Brands</p>
        </div>
      </div>
      <div class="card px-4 py-3 flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-blue-50 flex items-center justify-center text-lg">‚úÖ</div>
        <div>
          <p class="text-xl font-bold text-blue-600" id="activeBrands">0</p>
          <p class="text-xs text-slate-400">Active</p>
        </div>
      </div>
      <div class="card px-4 py-3 flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-purple-50 flex items-center justify-center text-lg">üì¶</div>
        <div>
          <p class="text-xl font-bold text-purple-600" id="totalProducts">0</p>
          <p class="text-xs text-slate-400">Products</p>
        </div>
      </div>
      <div class="card px-4 py-3 flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-amber-50 flex items-center justify-center text-lg">‚≠ê</div>
        <div>
          <p class="text-xl font-bold text-amber-600" id="featuredBrands">0</p>
          <p class="text-xs text-slate-400">Featured</p>
        </div>
      </div>
    </div>

    <!-- Search & Filter -->
    <div class="card p-3 mb-4 flex items-center gap-3">
      <div class="flex items-center gap-2 flex-1 bg-slate-50 rounded-lg px-3 py-2">
        <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
        <input type="text" id="searchInput" placeholder="Search brands..." class="bg-transparent border-0 text-sm w-full focus:outline-none" oninput="filterBrands()">
      </div>
      <select id="statusFilter" onchange="filterBrands()" class="input px-3 py-2 text-sm">
        <option value="">All Status</option>
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>
      <select id="featuredFilter" onchange="filterBrands()" class="input px-3 py-2 text-sm">
        <option value="">All Brands</option>
        <option value="featured">Featured Only</option>
      </select>
      <button onclick="resetFilters()" class="text-sm text-slate-500 hover:text-slate-700 px-2">Reset</button>
    </div>

    <!-- Table -->
    <div class="card overflow-hidden">
      <table class="w-full">
        <thead>
          <tr class="bg-slate-50 border-b border-slate-100">
            <th class="text-left p-4 text-xs font-semibold text-slate-500 uppercase w-16">Logo</th>
            <th class="text-left p-4 text-xs font-semibold text-slate-500 uppercase">Brand Name</th>
            <th class="text-center p-4 text-xs font-semibold text-slate-500 uppercase w-24">Products</th>
            <th class="text-center p-4 text-xs font-semibold text-slate-500 uppercase w-24">Featured</th>
            <th class="text-center p-4 text-xs font-semibold text-slate-500 uppercase w-24">Status</th>
            <th class="text-center p-4 text-xs font-semibold text-slate-500 uppercase w-28">Actions</th>
          </tr>
        </thead>
        <tbody id="brandsBody"></tbody>
      </table>
      <div id="emptyState" class="hidden py-12 text-center">
        <div class="w-14 h-14 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-3 text-2xl">üè∑Ô∏è</div>
        <p class="text-slate-500 text-sm">No brands found</p>
      </div>
    </div>
  </main>

  <!-- Add/Edit Modal -->
  <div id="brandModal" class="fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 p-4 hidden">
    <div class="card w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col">
      <!-- Modal Tabs -->
      <div class="flex border-b border-slate-100">
        <button onclick="switchModalTab('single')" id="tabSingle" class="flex-1 py-3 text-sm font-medium text-center tab-active">Single Brand</button>
        <button onclick="switchModalTab('multi')" id="tabMulti" class="flex-1 py-3 text-sm font-medium text-center text-slate-500 hover:text-slate-700">Quick Multi-Add</button>
      </div>

      <!-- Single Brand Form -->
      <div id="singleForm" class="p-5 overflow-y-auto flex-1">
        <div class="space-y-4">
          <!-- Logo Upload -->
          <div>
            <label class="text-xs font-medium text-slate-500 mb-1.5 block">Brand Logo</label>
            <div class="flex items-center gap-4">
              <div id="logoPreview" class="w-16 h-16 bg-slate-100 rounded-xl flex items-center justify-center text-2xl border-2 border-slate-200">üè∑Ô∏è</div>
              <div class="flex-1">
                <div class="logo-upload rounded-lg p-3 text-center cursor-pointer" onclick="document.getElementById('logoInput').click()">
                  <p class="text-xs text-slate-500">Click to upload logo</p>
                  <p class="text-[10px] text-slate-400">PNG, JPG (max 2MB)</p>
                </div>
                <input type="file" id="logoInput" accept="image/*" class="hidden" onchange="previewLogo(this)">
              </div>
            </div>
          </div>

          <!-- Brand Name -->
          <div>
            <label class="text-xs font-medium text-slate-500 mb-1.5 block">Brand Name *</label>
            <input type="text" id="brandName" class="input w-full px-3 py-2.5 text-sm">
          </div>

          <!-- Status & Featured -->
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="text-xs font-medium text-slate-500 mb-1.5 block">Status</label>
              <div class="flex gap-4">
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="radio" name="brandStatus" value="active" checked class="w-4 h-4 accent-emerald-500">
                  <span class="text-sm">Active</span>
                </label>
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="radio" name="brandStatus" value="inactive" class="w-4 h-4 accent-emerald-500">
                  <span class="text-sm">Inactive</span>
                </label>
              </div>
            </div>
            <div>
              <label class="text-xs font-medium text-slate-500 mb-1.5 block">Featured</label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="brandFeatured" class="w-4 h-4 accent-emerald-500 rounded">
                <span class="text-sm">Mark as featured</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Multi-Add Form -->
      <div id="multiForm" class="p-5 overflow-y-auto flex-1 hidden">
        <p class="text-xs text-slate-500 mb-3">Add multiple brands at once. Each row creates a new brand.</p>
        
        <!-- Header -->
        <div class="grid grid-cols-12 gap-2 px-2 py-2 bg-slate-50 rounded-lg mb-2 text-[10px] font-semibold text-slate-500 uppercase">
          <div class="col-span-6">Brand Name *</div>
          <div class="col-span-3">Status</div>
          <div class="col-span-2">Featured</div>
          <div class="col-span-1"></div>
        </div>

        <!-- Rows -->
        <div id="multiBrandRows" class="space-y-2 max-h-64 overflow-y-auto mb-3"></div>

        <button onclick="addMultiRow()" class="w-full py-2.5 border-2 border-dashed border-slate-200 hover:border-emerald-400 hover:bg-emerald-50 rounded-lg text-sm text-slate-500 hover:text-emerald-600 transition">
          + Add Row
        </button>
      </div>

      <!-- Footer -->
      <div class="p-4 border-t border-slate-100 flex gap-3">
        <button onclick="closeModal()" class="flex-1 btn-secondary py-2.5 rounded-lg text-sm">Cancel</button>
        <button onclick="saveBrand()" id="saveBtn" class="flex-1 btn-primary py-2.5 rounded-lg text-sm">Save Brand</button>
      </div>
    </div>
  </div>

  <!-- Delete Modal -->
  <div id="deleteModal" class="fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 p-4 hidden">
    <div class="card p-6 w-full max-w-sm text-center">
      <div class="w-12 h-12 rounded-full bg-red-50 flex items-center justify-center mx-auto mb-4 text-2xl">üóëÔ∏è</div>
      <h3 class="text-lg font-semibold text-slate-800 mb-1">Delete Brand?</h3>
      <p class="text-sm text-slate-500 mb-4" id="deleteWarning">This action cannot be undone.</p>
      <div class="flex gap-3">
        <button onclick="closeDeleteModal()" class="flex-1 btn-secondary py-2.5 rounded-lg text-sm">Cancel</button>
        <button onclick="confirmDelete()" class="flex-1 bg-red-500 hover:bg-red-600 text-white py-2.5 rounded-lg text-sm font-medium">Delete</button>
      </div>
    </div>
  </div>

  <script>
    var brands=[
      {id:1,name:'FarmFresh',logo:'ü•¨',status:'active',featured:true,products:45},
      {id:2,name:'DairyBest',logo:'ü•õ',status:'active',featured:true,products:28},
      {id:3,name:'BakeHouse',logo:'üçû',status:'active',featured:false,products:32},
      {id:4,name:'GreenLife',logo:'üåø',status:'active',featured:false,products:24},
      {id:5,name:'FreshSqueeze',logo:'üßÉ',status:'active',featured:true,products:18},
      {id:6,name:'CrunchTime',logo:'üçø',status:'active',featured:false,products:56},
      {id:7,name:'CleanPro',logo:'üßπ',status:'inactive',featured:false,products:15},
      {id:8,name:'AquaPure',logo:'üíß',status:'active',featured:false,products:8}
    ];

    var editingId=null,deleteId=null,currentTab='single';
    var multiRows=[{id:1,name:'',status:'active',featured:false}];
    var multiIdCounter=1;

    function updateSummary(){
      document.getElementById('totalBrands').textContent=brands.length;
      document.getElementById('activeBrands').textContent=brands.filter(b=>b.status==='active').length;
      document.getElementById('totalProducts').textContent=brands.reduce((s,b)=>s+b.products,0);
      document.getElementById('featuredBrands').textContent=brands.filter(b=>b.featured).length;
    }

    function filterBrands(){renderBrands()}

    function getFiltered(){
      var search=document.getElementById('searchInput').value.toLowerCase();
      var status=document.getElementById('statusFilter').value;
      var featured=document.getElementById('featuredFilter').value;
      return brands.filter(b=>{
        if(search&&b.name.toLowerCase().indexOf(search)===-1)return false;
        if(status&&b.status!==status)return false;
        if(featured==='featured'&&!b.featured)return false;
        return true;
      });
    }

    function renderBrands(){
      var filtered=getFiltered();
      var tbody=document.getElementById('brandsBody');
      var html='';

      for(var i=0;i<filtered.length;i++){
        var b=filtered[i];
        html+='<tr class="border-b border-slate-50 row-hover">';
        html+='<td class="p-4"><div class="w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center text-xl">'+b.logo+'</div></td>';
        html+='<td class="p-4"><p class="font-medium text-slate-800">'+b.name+'</p></td>';
        html+='<td class="p-4 text-center"><span class="text-sm font-medium text-slate-600">'+b.products+'</span></td>';
        html+='<td class="p-4 text-center">'+(b.featured?'<span class="text-amber-500">‚≠ê</span>':'<span class="text-slate-200">‚òÜ</span>')+'</td>';
        html+='<td class="p-4 text-center"><span class="px-2 py-1 rounded-full text-xs font-medium '+(b.status==='active'?'bg-emerald-50 text-emerald-600':'bg-slate-100 text-slate-500')+'">'+(b.status==='active'?'Active':'Inactive')+'</span></td>';
        html+='<td class="p-4 text-center"><div class="flex items-center justify-center gap-1">';
        html+='<button onclick="editBrand('+b.id+')" class="p-2 hover:bg-slate-100 rounded-lg text-slate-400 hover:text-slate-600"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg></button>';
        html+='<button onclick="deleteBrand('+b.id+')" class="p-2 hover:bg-red-50 rounded-lg text-slate-400 hover:text-red-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>';
        html+='</div></td></tr>';
      }

      tbody.innerHTML=html;
      document.getElementById('emptyState').classList.toggle('hidden',filtered.length>0);
      document.querySelector('table').classList.toggle('hidden',filtered.length===0);
      updateSummary();
    }

    function resetFilters(){
      document.getElementById('searchInput').value='';
      document.getElementById('statusFilter').value='';
      document.getElementById('featuredFilter').value='';
      filterBrands();
    }

    function switchModalTab(tab){
      currentTab=tab;
      document.getElementById('singleForm').classList.toggle('hidden',tab!=='single');
      document.getElementById('multiForm').classList.toggle('hidden',tab!=='multi');
      document.getElementById('tabSingle').classList.toggle('tab-active',tab==='single');
      document.getElementById('tabMulti').classList.toggle('tab-active',tab==='multi');
      document.getElementById('tabSingle').classList.toggle('text-slate-500',tab!=='single');
      document.getElementById('tabMulti').classList.toggle('text-slate-500',tab!=='multi');
      document.getElementById('saveBtn').textContent=tab==='single'?(editingId?'Update Brand':'Save Brand'):'Save All Brands';
      if(tab==='multi')renderMultiRows();
    }

    function previewLogo(input){
      if(input.files&&input.files[0]){
        var reader=new FileReader();
        reader.onload=function(e){
          document.getElementById('logoPreview').innerHTML='<img src="'+e.target.result+'" class="w-full h-full object-cover rounded-xl">';
        };
        reader.readAsDataURL(input.files[0]);
      }
    }

    // Multi-Add Functions
    function renderMultiRows(){
      var html='';
      for(var i=0;i<multiRows.length;i++){
        var r=multiRows[i];
        html+='<div class="fade-in grid grid-cols-12 gap-2 items-center">';
        html+='<div class="col-span-6"><input type="text" value="'+r.name+'" onchange="updateMultiRow('+r.id+',\'name\',this.value)" class="input w-full px-3 py-2 text-sm"></div>';
        html+='<div class="col-span-3"><button onclick="toggleMultiStatus('+r.id+')" class="w-full py-2 rounded-lg text-xs font-medium '+(r.status==='active'?'bg-emerald-50 text-emerald-600':'bg-slate-100 text-slate-400')+'">'+(r.status==='active'?'Active':'Inactive')+'</button></div>';
        html+='<div class="col-span-2 text-center"><button onclick="toggleMultiFeatured('+r.id+')" class="text-xl">'+(r.featured?'‚≠ê':'‚òÜ')+'</button></div>';
        html+='<div class="col-span-1 text-center">';
        if(multiRows.length>1)html+='<button onclick="removeMultiRow('+r.id+')" class="p-1.5 text-slate-400 hover:text-red-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12"/></svg></button>';
        html+='</div></div>';
      }
      document.getElementById('multiBrandRows').innerHTML=html;
    }

    function addMultiRow(){
      multiIdCounter++;
      multiRows.push({id:multiIdCounter,name:'',status:'active',featured:false});
      renderMultiRows();
    }

    function removeMultiRow(id){
      multiRows=multiRows.filter(r=>r.id!==id);
      renderMultiRows();
    }

    function updateMultiRow(id,field,value){
      var r=multiRows.find(r=>r.id===id);
      if(r)r[field]=value;
    }

    function toggleMultiStatus(id){
      var r=multiRows.find(r=>r.id===id);
      if(r)r.status=r.status==='active'?'inactive':'active';
      renderMultiRows();
    }

    function toggleMultiFeatured(id){
      var r=multiRows.find(r=>r.id===id);
      if(r)r.featured=!r.featured;
      renderMultiRows();
    }

    function openAddModal(){
      editingId=null;
      currentTab='single';
      document.getElementById('brandName').value='';
      document.getElementById('logoPreview').innerHTML='üè∑Ô∏è';
      document.getElementById('logoInput').value='';
      document.querySelector('input[name="brandStatus"][value="active"]').checked=true;
      document.getElementById('brandFeatured').checked=false;
      multiRows=[{id:1,name:'',status:'active',featured:false}];
      multiIdCounter=1;
      switchModalTab('single');
      document.getElementById('tabMulti').classList.remove('hidden');
      document.getElementById('brandModal').classList.remove('hidden');
    }

    function editBrand(id){
      var b=brands.find(x=>x.id===id);
      if(!b)return;
      editingId=id;
      currentTab='single';
      document.getElementById('brandName').value=b.name;
      document.getElementById('logoPreview').innerHTML=b.logo;
      document.querySelector('input[name="brandStatus"][value="'+b.status+'"]').checked=true;
      document.getElementById('brandFeatured').checked=b.featured;
      switchModalTab('single');
      document.getElementById('tabMulti').classList.add('hidden');
      document.getElementById('brandModal').classList.remove('hidden');
    }

    function closeModal(){
      document.getElementById('brandModal').classList.add('hidden');
      editingId=null;
    }

    function saveBrand(){
      if(currentTab==='single'){
        var name=document.getElementById('brandName').value.trim();
        if(!name){alert('Enter brand name');return}
        var status=document.querySelector('input[name="brandStatus"]:checked').value;
        var featured=document.getElementById('brandFeatured').checked;

        if(editingId){
          var b=brands.find(x=>x.id===editingId);
          if(b){b.name=name;b.status=status;b.featured=featured}
        }else{
          var newId=Math.max(...brands.map(b=>b.id))+1;
          brands.push({id:newId,name:name,logo:'üè∑Ô∏è',status:status,featured:featured,products:0});
        }
      }else{
        var valid=multiRows.filter(r=>r.name.trim()!=='');
        if(!valid.length){alert('Enter at least one brand name');return}
        for(var i=0;i<valid.length;i++){
          var r=valid[i];
          var newId=Math.max(...brands.map(b=>b.id))+1;
          brands.push({id:newId,name:r.name.trim(),logo:'üè∑Ô∏è',status:r.status,featured:r.featured,products:0});
        }
      }
      closeModal();
      renderBrands();
    }

    function deleteBrand(id){
      var b=brands.find(x=>x.id===id);
      if(!b)return;
      deleteId=id;
      document.getElementById('deleteWarning').textContent=b.products>0?'‚ö†Ô∏è '+b.products+' products will be unassigned.':'This action cannot be undone.';
      document.getElementById('deleteModal').classList.remove('hidden');
    }

    function closeDeleteModal(){
      document.getElementById('deleteModal').classList.add('hidden');
      deleteId=null;
    }

    function confirmDelete(){
      if(deleteId){
        brands=brands.filter(b=>b.id!==deleteId);
        renderBrands();
      }
      closeDeleteModal();
    }

    renderBrands();
  </script>
</body>
</html>
