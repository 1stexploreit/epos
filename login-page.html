<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sign in - FreshMart</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*{font-family:'Inter',sans-serif}
input:focus{outline:none}
.step{display:none}
.step.active{display:block}
.otp-input{width:48px;height:48px;text-align:center;font-size:20px;font-weight:600}
.theme-color.active{ring:2px;ring-offset:2px;box-shadow:0 0 0 2px white, 0 0 0 4px currentColor}
.bg-mode.active{background-color:#f1f5f9}

/* Theme Variables */
:root{--primary:16 185 129;--primary-dark:5 150 105}
[data-theme="emerald"]{--primary:16 185 129;--primary-dark:5 150 105}
[data-theme="blue"]{--primary:59 130 246;--primary-dark:37 99 235}
[data-theme="purple"]{--primary:168 85 247;--primary-dark:147 51 234}
[data-theme="rose"]{--primary:244 63 94;--primary-dark:225 29 72}
[data-theme="amber"]{--primary:245 158 11;--primary-dark:217 119 6}

.bg-primary{background-color:rgb(var(--primary))}
.bg-primary-dark{background-color:rgb(var(--primary-dark))}
.hover\:bg-primary-dark:hover{background-color:rgb(var(--primary-dark))}
.text-primary{color:rgb(var(--primary))}
.bg-primary-light{background-color:rgb(var(--primary)/0.1)}
.border-primary{border-color:rgb(var(--primary))}
.focus\:border-primary:focus{border-color:rgb(var(--primary))}
.ring-primary{--tw-ring-color:rgb(var(--primary))}

/* Dark Mode */
body.dark{background-color:#0f172a}
body.dark .bg-white{background-color:#1e293b}
body.dark .text-slate-800{color:#f1f5f9}
body.dark .text-slate-700{color:#e2e8f0}
body.dark .text-slate-600{color:#cbd5e1}
body.dark .text-slate-500{color:#94a3b8}
body.dark .border-slate-200{border-color:#334155}
body.dark .border-slate-300{border-color:#475569}
body.dark .bg-slate-50{background-color:#334155}
body.dark .bg-slate-100{background-color:#1e293b}
body.dark .hover\:bg-slate-50:hover{background-color:#334155}
body.dark input{background-color:#1e293b;color:#f1f5f9}
body.dark input::placeholder{color:#64748b}
body.dark #themeMenu{background-color:#1e293b;border-color:#334155}
body.dark #themeMenu .text-slate-700{color:#e2e8f0}
body.dark #themeMenu .hover\:bg-slate-50:hover{background-color:#334155}
body.dark #themeBtn{background-color:#1e293b;border-color:#334155}
body.dark #themeBtn svg{color:#94a3b8}
</style>
</head>
<body class="min-h-screen bg-slate-100 flex items-center justify-center p-4 transition-colors duration-300">

<!-- Theme Toggle Button -->
<div class="fixed top-4 right-4 z-50">
<button onclick="toggleThemeMenu()" id="themeBtn" class="w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center hover:shadow-xl transition-all border border-slate-200">
<svg class="w-5 h-5 text-slate-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
</svg>
</button>

<!-- Theme Menu -->
<div id="themeMenu" class="absolute top-12 right-0 bg-white rounded-xl shadow-2xl border border-slate-200 p-4 w-56 hidden">
<p class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3">Theme Color</p>
<div class="grid grid-cols-5 gap-2 mb-4">
<button onclick="setTheme('emerald')" class="w-8 h-8 rounded-full bg-emerald-500 hover:scale-110 transition-transform theme-color" data-color="emerald"></button>
<button onclick="setTheme('blue')" class="w-8 h-8 rounded-full bg-blue-500 hover:scale-110 transition-transform theme-color" data-color="blue"></button>
<button onclick="setTheme('purple')" class="w-8 h-8 rounded-full bg-purple-500 hover:scale-110 transition-transform theme-color" data-color="purple"></button>
<button onclick="setTheme('rose')" class="w-8 h-8 rounded-full bg-rose-500 hover:scale-110 transition-transform theme-color" data-color="rose"></button>
<button onclick="setTheme('amber')" class="w-8 h-8 rounded-full bg-amber-500 hover:scale-110 transition-transform theme-color" data-color="amber"></button>
</div>
<p class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3">Background</p>
<div class="space-y-2">
<button onclick="setBackground('light')" class="w-full flex items-center gap-3 p-2 rounded-lg hover:bg-slate-50 transition-colors bg-mode" data-mode="light">
<div class="w-6 h-6 rounded-full bg-slate-100 border border-slate-300"></div>
<span class="text-sm text-slate-700">Light</span>
</button>
<button onclick="setBackground('dark')" class="w-full flex items-center gap-3 p-2 rounded-lg hover:bg-slate-50 transition-colors bg-mode" data-mode="dark">
<div class="w-6 h-6 rounded-full bg-slate-800 border border-slate-600"></div>
<span class="text-sm text-slate-700">Dark</span>
</button>
</div>
</div>
</div>

<div class="w-full max-w-[440px]">
<!-- Card -->
<div class="bg-white rounded-lg shadow-lg p-10">
<!-- Logo -->
<div class="flex items-center gap-2.5 mb-8">
<div class="w-9 h-9 bg-primary rounded flex items-center justify-center">
<svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
</svg>
</div>
<span class="text-xl font-semibold text-slate-800">FreshMart</span>
</div>

<!-- Step 1: Email (Sign In) -->
<div id="step1" class="step active">
<h1 class="text-2xl font-semibold text-slate-800 mb-2">Sign in</h1>
<p class="text-sm text-slate-500 mb-6">to continue to FreshMart POS</p>

<div class="space-y-4">
<div>
<input type="email" id="email" class="w-full px-4 py-3 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="Email or phone" autofocus>
<p id="emailError" class="text-xs text-red-500 mt-1.5 hidden">Enter a valid email address</p>
</div>

<p class="text-sm text-slate-600">
Not your device? Use a private browsing window to sign in. <a href="#" class="text-primary hover:underline">Learn more</a>
</p>

<div class="flex items-center justify-between pt-4">
<a href="#" onclick="goToRegister()" class="text-sm text-primary hover:underline font-medium">Create account</a>
<button onclick="goToStep2()" class="px-6 py-2.5 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors">
Next
</button>
</div>
</div>
</div>

<!-- Step 2: Password (Sign In) -->
<div id="step2" class="step">
<button onclick="goToStep1()" class="flex items-center gap-1 text-sm text-slate-500 hover:text-slate-700 mb-4">
<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
</svg>
Back
</button>

<h1 class="text-2xl font-semibold text-slate-800 mb-2">Welcome</h1>
<div class="flex items-center gap-2 mb-6 p-2 bg-slate-50 rounded-lg w-fit">
<div class="w-7 h-7 bg-primary-light rounded-full flex items-center justify-center">
<svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
</svg>
</div>
<span id="displayEmail" class="text-sm text-slate-600"></span>
</div>

<div class="space-y-4">
<div class="relative">
<input type="password" id="password" class="w-full px-4 py-3 pr-12 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="Enter password">
<button type="button" onclick="togglePassword('password')" class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 p-1">
<svg id="eyeIcon" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
<path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
</svg>
</button>
<p id="passError" class="text-xs text-red-500 mt-1.5 hidden">Password is required</p>
</div>

<div class="flex items-center gap-2">
<input type="checkbox" id="showPass" class="w-4 h-4 rounded border-slate-300 text-primary accent-primary focus:ring-primary" onchange="toggleShowPassword()">
<label for="showPass" class="text-sm text-slate-600">Show password</label>
</div>

<div class="flex items-center justify-between pt-4">
<a href="#" onclick="goToForgotPassword()" class="text-sm text-primary hover:underline font-medium">Forgot password?</a>
<button onclick="handleLogin()" id="loginBtn" class="px-6 py-2.5 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors flex items-center gap-2">
Sign in
</button>
</div>
</div>
</div>

<!-- Step 3: Account Selection -->
<div id="step3" class="step">
<h1 class="text-2xl font-semibold text-slate-800 mb-2">Choose an account</h1>
<p class="text-sm text-slate-500 mb-6">to continue to FreshMart POS</p>

<div class="space-y-2">
<button onclick="selectAccount('admin@freshmart.com')" class="w-full flex items-center gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors text-left">
<div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
<span class="text-purple-600 font-medium">A</span>
</div>
<div class="flex-1">
<p class="text-sm font-medium text-slate-800">Admin User</p>
<p class="text-xs text-slate-500">admin@freshmart.com</p>
</div>
<svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
</svg>
</button>

<button onclick="selectAccount('manager@freshmart.com')" class="w-full flex items-center gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors text-left">
<div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
<span class="text-blue-600 font-medium">M</span>
</div>
<div class="flex-1">
<p class="text-sm font-medium text-slate-800">Manager</p>
<p class="text-xs text-slate-500">manager@freshmart.com</p>
</div>
<svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
</svg>
</button>

<button onclick="goToStep1()" class="w-full flex items-center gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors text-left">
<div class="w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center">
<svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/>
</svg>
</div>
<div class="flex-1">
<p class="text-sm font-medium text-slate-800">Use another account</p>
</div>
<svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
</svg>
</button>
</div>
</div>

<!-- Step 4: Create Account -->
<div id="step4" class="step">
<button onclick="goToStep1()" class="flex items-center gap-1 text-sm text-slate-500 hover:text-slate-700 mb-4">
<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
</svg>
Back to sign in
</button>

<h1 class="text-2xl font-semibold text-slate-800 mb-2">Create account</h1>
<p class="text-sm text-slate-500 mb-6">Enter your details to get started</p>

<div class="space-y-4">
<div class="grid grid-cols-2 gap-3">
<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">First name</label>
<input type="text" id="firstName" class="w-full px-4 py-3 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="John">
</div>
<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">Last name</label>
<input type="text" id="lastName" class="w-full px-4 py-3 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="Doe">
</div>
</div>

<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">Email address</label>
<input type="email" id="regEmail" class="w-full px-4 py-3 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="you@example.com">
<p id="regEmailError" class="text-xs text-red-500 mt-1.5 hidden">Enter a valid email address</p>
</div>

<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">Phone number</label>
<input type="tel" id="regPhone" class="w-full px-4 py-3 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="+880 1XXX XXXXXX">
</div>

<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">Password</label>
<div class="relative">
<input type="password" id="regPassword" class="w-full px-4 py-3 pr-12 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="Create password">
<button type="button" onclick="togglePassword('regPassword')" class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 p-1">
<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
<path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
</svg>
</button>
</div>
<p class="text-xs text-slate-400 mt-1">Minimum 8 characters</p>
</div>

<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">Confirm password</label>
<input type="password" id="regConfirmPassword" class="w-full px-4 py-3 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="Confirm password">
<p id="confirmError" class="text-xs text-red-500 mt-1.5 hidden">Passwords do not match</p>
</div>

<div class="flex items-start gap-2 pt-2">
<input type="checkbox" id="agreeTerms" class="w-4 h-4 rounded border-slate-300 text-primary accent-primary focus:ring-primary mt-0.5">
<label for="agreeTerms" class="text-sm text-slate-600">I agree to the <a href="#" class="text-primary hover:underline">Terms of Service</a> and <a href="#" class="text-primary hover:underline">Privacy Policy</a></label>
</div>

<div class="pt-2">
<button onclick="sendOTP()" id="sendOtpBtn" class="w-full py-3 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors flex items-center justify-center gap-2">
Continue
</button>
</div>
</div>
</div>

<!-- Step 5: OTP Verification -->
<div id="step5" class="step">
<button onclick="showStep(4)" class="flex items-center gap-1 text-sm text-slate-500 hover:text-slate-700 mb-4">
<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
</svg>
Back
</button>

<div class="text-center mb-6">
<div class="w-16 h-16 bg-primary-light rounded-full flex items-center justify-center mx-auto mb-4">
<svg class="w-8 h-8 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
</svg>
</div>
<h1 class="text-2xl font-semibold text-slate-800 mb-2">Verify your phone</h1>
<p class="text-sm text-slate-500">We've sent a 6-digit code to</p>
<p class="text-sm font-medium text-slate-700" id="otpPhone">+880 1XXX XXXXXX</p>
</div>

<div class="space-y-4">
<div>
<label class="text-xs font-medium text-slate-600 mb-2 block text-center">Enter verification code</label>
<div class="flex justify-center gap-2" id="otpInputs">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleOtpInput(this, 0)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleOtpInput(this, 1)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleOtpInput(this, 2)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleOtpInput(this, 3)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleOtpInput(this, 4)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleOtpInput(this, 5)">
</div>
<p id="otpError" class="text-xs text-red-500 mt-2 text-center hidden">Invalid verification code</p>
</div>

<div class="text-center">
<p class="text-sm text-slate-500">Didn't receive the code?</p>
<button onclick="resendOTP()" id="resendBtn" class="text-sm text-primary hover:underline font-medium mt-1">Resend code</button>
<p id="resendTimer" class="text-sm text-slate-400 mt-1 hidden">Resend in <span id="timerCount">60</span>s</p>
</div>

<div class="pt-2">
<button onclick="verifyOTP()" id="verifyBtn" class="w-full py-3 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors flex items-center justify-center gap-2">
Verify & Create Account
</button>
</div>
</div>
</div>

<!-- Step 6: Success -->
<div id="step6" class="step">
<div class="text-center py-6">
<div class="w-20 h-20 bg-primary-light rounded-full flex items-center justify-center mx-auto mb-6">
<svg class="w-10 h-10 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
</svg>
</div>
<h1 class="text-2xl font-semibold text-slate-800 mb-2">Account created!</h1>
<p class="text-sm text-slate-500 mb-6">Your account has been successfully created. You can now sign in.</p>
<button onclick="goToStep1()" class="w-full py-3 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors">
Sign in to your account
</button>
</div>
</div>

<!-- Step 7: Forgot Password - Enter Phone -->
<div id="step7" class="step">
<button onclick="goToStep1()" class="flex items-center gap-1 text-sm text-slate-500 hover:text-slate-700 mb-4">
<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
</svg>
Back to sign in
</button>

<div class="mb-6">
<div class="w-14 h-14 bg-amber-100 rounded-full flex items-center justify-center mb-4">
<svg class="w-7 h-7 text-amber-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
</svg>
</div>
<h1 class="text-2xl font-semibold text-slate-800 mb-2">Reset password</h1>
<p class="text-sm text-slate-500">Enter your phone number and we'll send you a code to reset your password.</p>
</div>

<div class="space-y-4">
<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">Phone number</label>
<input type="tel" id="forgotPhone" class="w-full px-4 py-3 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="+880 1XXX XXXXXX">
<p id="forgotPhoneError" class="text-xs text-red-500 mt-1.5 hidden">Enter a valid phone number</p>
</div>

<button onclick="sendResetOTP()" id="sendResetBtn" class="w-full py-3 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors flex items-center justify-center gap-2">
Send reset code
</button>
</div>
</div>

<!-- Step 8: Forgot Password - Enter OTP -->
<div id="step8" class="step">
<button onclick="showStep(7)" class="flex items-center gap-1 text-sm text-slate-500 hover:text-slate-700 mb-4">
<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
</svg>
Back
</button>

<div class="text-center mb-6">
<div class="w-16 h-16 bg-primary-light rounded-full flex items-center justify-center mx-auto mb-4">
<svg class="w-8 h-8 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
</svg>
</div>
<h1 class="text-2xl font-semibold text-slate-800 mb-2">Verify your phone</h1>
<p class="text-sm text-slate-500">We've sent a 6-digit code to</p>
<p class="text-sm font-medium text-slate-700" id="resetOtpPhone">+880 1XXX XXXXXX</p>
</div>

<div class="space-y-4">
<div>
<label class="text-xs font-medium text-slate-600 mb-2 block text-center">Enter verification code</label>
<div class="flex justify-center gap-2" id="resetOtpInputs">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleResetOtpInput(this, 0)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleResetOtpInput(this, 1)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleResetOtpInput(this, 2)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleResetOtpInput(this, 3)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleResetOtpInput(this, 4)">
<input type="text" maxlength="1" class="otp-input border border-slate-300 rounded-lg focus:border-primary" oninput="handleResetOtpInput(this, 5)">
</div>
<p id="resetOtpError" class="text-xs text-red-500 mt-2 text-center hidden">Invalid verification code</p>
</div>

<div class="text-center">
<p class="text-sm text-slate-500">Didn't receive the code?</p>
<button onclick="resendResetOTP()" id="resendResetBtn" class="text-sm text-primary hover:underline font-medium mt-1">Resend code</button>
<p id="resendResetTimer" class="text-sm text-slate-400 mt-1 hidden">Resend in <span id="resetTimerCount">60</span>s</p>
</div>

<button onclick="verifyResetOTP()" id="verifyResetBtn" class="w-full py-3 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors flex items-center justify-center gap-2">
Verify code
</button>
</div>
</div>

<!-- Step 9: Create New Password -->
<div id="step9" class="step">
<div class="mb-6">
<div class="w-14 h-14 bg-primary-light rounded-full flex items-center justify-center mb-4">
<svg class="w-7 h-7 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
</svg>
</div>
<h1 class="text-2xl font-semibold text-slate-800 mb-2">Create new password</h1>
<p class="text-sm text-slate-500">Your new password must be different from previous passwords.</p>
</div>

<div class="space-y-4">
<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">New password</label>
<div class="relative">
<input type="password" id="newPassword" class="w-full px-4 py-3 pr-12 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="Enter new password">
<button type="button" onclick="togglePassword('newPassword')" class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 p-1">
<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
<path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
</svg>
</button>
</div>
<p class="text-xs text-slate-400 mt-1">Minimum 8 characters</p>
</div>

<div>
<label class="text-xs font-medium text-slate-600 mb-1 block">Confirm new password</label>
<input type="password" id="confirmNewPassword" class="w-full px-4 py-3 border border-slate-300 rounded text-sm hover:border-slate-400 transition-colors" placeholder="Confirm new password">
<p id="newConfirmError" class="text-xs text-red-500 mt-1.5 hidden">Passwords do not match</p>
</div>

<button onclick="resetPassword()" id="resetPassBtn" class="w-full py-3 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors flex items-center justify-center gap-2">
Reset password
</button>
</div>
</div>

<!-- Step 10: Password Reset Success -->
<div id="step10" class="step">
<div class="text-center py-6">
<div class="w-20 h-20 bg-primary-light rounded-full flex items-center justify-center mx-auto mb-6">
<svg class="w-10 h-10 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
</svg>
</div>
<h1 class="text-2xl font-semibold text-slate-800 mb-2">Password reset!</h1>
<p class="text-sm text-slate-500 mb-6">Your password has been successfully reset. You can now sign in with your new password.</p>
<button onclick="goToStep1()" class="w-full py-3 bg-primary hover:bg-primary-dark text-white text-sm font-medium rounded transition-colors">
Sign in
</button>
</div>
</div>
</div>

<!-- Footer Links -->
<div class="flex items-center justify-between mt-6 text-xs text-slate-500">
<div class="flex items-center gap-4">
<a href="#" class="hover:text-slate-700">Terms</a>
<a href="#" class="hover:text-slate-700">Privacy</a>
<a href="#" class="hover:text-slate-700">Help</a>
</div>
<select class="bg-transparent text-xs text-slate-500 cursor-pointer hover:text-slate-700">
<option>English (United States)</option>
<option>বাংলা</option>
<option>हिन्दी</option>
</select>
</div>
</div>

<!-- Toast -->
<div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 z-50 px-4 py-3 bg-slate-800 text-white text-sm rounded-lg shadow-lg flex items-center gap-2 opacity-0 translate-y-4 transition-all duration-300">
<svg id="toastIcon" class="w-5 h-5 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
<path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
</svg>
<span id="toastMsg">Success</span>
</div>

<script>
let currentStep = 1;
let resendInterval = null;
let resetResendInterval = null;

// Theme Functions
function initTheme() {
const savedTheme = localStorage.getItem('theme') || 'emerald';
const savedBg = localStorage.getItem('background') || 'light';
setTheme(savedTheme, false);
setBackground(savedBg, false);
}

function toggleThemeMenu() {
const menu = document.getElementById('themeMenu');
menu.classList.toggle('hidden');
}

// Close theme menu when clicking outside
document.addEventListener('click', function(e) {
const menu = document.getElementById('themeMenu');
const btn = document.getElementById('themeBtn');
if (!menu.contains(e.target) && !btn.contains(e.target)) {
menu.classList.add('hidden');
}
});

function setTheme(color, save = true) {
document.documentElement.setAttribute('data-theme', color);
if (save) localStorage.setItem('theme', color);

// Update active state
document.querySelectorAll('.theme-color').forEach(btn => {
btn.classList.remove('active');
if (btn.dataset.color === color) {
btn.classList.add('active');
btn.style.boxShadow = '0 0 0 2px white, 0 0 0 4px currentColor';
} else {
btn.style.boxShadow = '';
}
});
}

function setBackground(mode, save = true) {
if (mode === 'dark') {
document.body.classList.add('dark');
} else {
document.body.classList.remove('dark');
}
if (save) localStorage.setItem('background', mode);

// Update active state
document.querySelectorAll('.bg-mode').forEach(btn => {
btn.classList.remove('active');
if (btn.dataset.mode === mode) {
btn.classList.add('active');
}
});
}

// Initialize theme on load
initTheme();

function showStep(step) {
document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
document.getElementById('step' + step).classList.add('active');
currentStep = step;
}

function goToStep1() {
showStep(1);
document.getElementById('email').focus();
}

function goToStep2() {
const email = document.getElementById('email').value.trim();
const emailError = document.getElementById('emailError');

if (!email || !email.includes('@')) {
emailError.classList.remove('hidden');
document.getElementById('email').classList.add('border-red-500');
return;
}

emailError.classList.add('hidden');
document.getElementById('email').classList.remove('border-red-500');
document.getElementById('displayEmail').textContent = email;
showStep(2);
document.getElementById('password').focus();
}

function goToRegister() {
showStep(4);
document.getElementById('firstName').focus();
}

function selectAccount(email) {
document.getElementById('email').value = email;
document.getElementById('displayEmail').textContent = email;
showStep(2);
document.getElementById('password').focus();
}

function togglePassword(inputId) {
const input = document.getElementById(inputId);
input.type = input.type === 'password' ? 'text' : 'password';
}

function toggleShowPassword() {
const checkbox = document.getElementById('showPass');
document.getElementById('password').type = checkbox.checked ? 'text' : 'password';
}

function showToast(msg, isError = false) {
const t = document.getElementById('toast');
const icon = document.getElementById('toastIcon');
document.getElementById('toastMsg').textContent = msg;
icon.classList.toggle('text-primary', !isError);
icon.classList.toggle('text-red-400', isError);
icon.innerHTML = isError 
? '<path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>'
: '<path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>';
t.style.opacity = '1';
t.style.transform = 'translateX(-50%) translateY(0)';
setTimeout(() => {
t.style.opacity = '0';
t.style.transform = 'translateX(-50%) translateY(16px)';
}, 3000);
}

function handleLogin() {
const password = document.getElementById('password').value;
const passError = document.getElementById('passError');
const btn = document.getElementById('loginBtn');

if (!password) {
passError.classList.remove('hidden');
document.getElementById('password').classList.add('border-red-500');
return;
}

passError.classList.add('hidden');
document.getElementById('password').classList.remove('border-red-500');

btn.innerHTML = '<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';
btn.disabled = true;

setTimeout(() => {
btn.innerHTML = 'Sign in';
btn.disabled = false;
showToast('Signed in successfully! Redirecting...');
}, 1500);
}

function sendOTP() {
const firstName = document.getElementById('firstName').value.trim();
const lastName = document.getElementById('lastName').value.trim();
const email = document.getElementById('regEmail').value.trim();
const phone = document.getElementById('regPhone').value.trim();
const password = document.getElementById('regPassword').value;
const confirmPassword = document.getElementById('regConfirmPassword').value;
const agreeTerms = document.getElementById('agreeTerms').checked;

// Validation
if (!firstName || !lastName) {
showToast('Please enter your full name', true);
return;
}
if (!email || !email.includes('@')) {
document.getElementById('regEmailError').classList.remove('hidden');
return;
}
document.getElementById('regEmailError').classList.add('hidden');

if (!phone) {
showToast('Please enter your phone number', true);
return;
}
if (password.length < 8) {
showToast('Password must be at least 8 characters', true);
return;
}
if (password !== confirmPassword) {
document.getElementById('confirmError').classList.remove('hidden');
return;
}
document.getElementById('confirmError').classList.add('hidden');

if (!agreeTerms) {
showToast('Please agree to the terms and conditions', true);
return;
}

const btn = document.getElementById('sendOtpBtn');
btn.innerHTML = '<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span>Sending code...</span>';
btn.disabled = true;

setTimeout(() => {
btn.innerHTML = 'Continue';
btn.disabled = false;
document.getElementById('otpPhone').textContent = phone;
showStep(5);
startResendTimer();
showToast('Verification code sent to your phone');
// Focus first OTP input
document.querySelector('#otpInputs input').focus();
}, 1500);
}

function handleOtpInput(input, index) {
const inputs = document.querySelectorAll('#otpInputs input');
input.value = input.value.replace(/[^0-9]/g, '');
if (input.value && index < 5) {
inputs[index + 1].focus();
}
}

// Handle backspace in OTP inputs
document.addEventListener('keydown', function(e) {
if (e.key === 'Backspace') {
if (currentStep === 5) {
const inputs = document.querySelectorAll('#otpInputs input');
const focused = document.activeElement;
const index = Array.from(inputs).indexOf(focused);
if (index > 0 && !focused.value) {
inputs[index - 1].focus();
}
} else if (currentStep === 8) {
const inputs = document.querySelectorAll('#resetOtpInputs input');
const focused = document.activeElement;
const index = Array.from(inputs).indexOf(focused);
if (index > 0 && !focused.value) {
inputs[index - 1].focus();
}
}
}
});

function startResendTimer() {
let seconds = 60;
document.getElementById('resendBtn').classList.add('hidden');
document.getElementById('resendTimer').classList.remove('hidden');
document.getElementById('timerCount').textContent = seconds;

if (resendInterval) clearInterval(resendInterval);

resendInterval = setInterval(() => {
seconds--;
document.getElementById('timerCount').textContent = seconds;
if (seconds <= 0) {
clearInterval(resendInterval);
document.getElementById('resendBtn').classList.remove('hidden');
document.getElementById('resendTimer').classList.add('hidden');
}
}, 1000);
}

function resendOTP() {
showToast('Verification code resent to your phone');
startResendTimer();
}

function verifyOTP() {
const inputs = document.querySelectorAll('#otpInputs input');
let otp = '';
inputs.forEach(input => otp += input.value);

if (otp.length !== 6) {
document.getElementById('otpError').classList.remove('hidden');
return;
}

document.getElementById('otpError').classList.add('hidden');
const btn = document.getElementById('verifyBtn');
btn.innerHTML = '<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span>Verifying...</span>';
btn.disabled = true;

setTimeout(() => {
btn.innerHTML = 'Verify & Create Account';
btn.disabled = false;
if (resendInterval) clearInterval(resendInterval);
showStep(6);
}, 1500);
}

// Handle Enter key
document.getElementById('email').addEventListener('keypress', function(e) {
if (e.key === 'Enter') goToStep2();
});

document.getElementById('password').addEventListener('keypress', function(e) {
if (e.key === 'Enter') handleLogin();
});

document.getElementById('forgotPhone').addEventListener('keypress', function(e) {
if (e.key === 'Enter') sendResetOTP();
});

document.getElementById('confirmNewPassword').addEventListener('keypress', function(e) {
if (e.key === 'Enter') resetPassword();
});

// Forgot Password Functions
function goToForgotPassword() {
showStep(7);
document.getElementById('forgotPhone').focus();
}

function sendResetOTP() {
const phone = document.getElementById('forgotPhone').value.trim();
const phoneError = document.getElementById('forgotPhoneError');

if (!phone || phone.length < 10) {
phoneError.classList.remove('hidden');
document.getElementById('forgotPhone').classList.add('border-red-500');
return;
}

phoneError.classList.add('hidden');
document.getElementById('forgotPhone').classList.remove('border-red-500');

const btn = document.getElementById('sendResetBtn');
btn.innerHTML = '<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span>Sending code...</span>';
btn.disabled = true;

setTimeout(() => {
btn.innerHTML = 'Send reset code';
btn.disabled = false;
document.getElementById('resetOtpPhone').textContent = phone;
showStep(8);
startResetResendTimer();
showToast('Reset code sent to your phone');
document.querySelector('#resetOtpInputs input').focus();
}, 1500);
}

function handleResetOtpInput(input, index) {
const inputs = document.querySelectorAll('#resetOtpInputs input');
input.value = input.value.replace(/[^0-9]/g, '');
if (input.value && index < 5) {
inputs[index + 1].focus();
}
}

function startResetResendTimer() {
let seconds = 60;
document.getElementById('resendResetBtn').classList.add('hidden');
document.getElementById('resendResetTimer').classList.remove('hidden');
document.getElementById('resetTimerCount').textContent = seconds;

if (resetResendInterval) clearInterval(resetResendInterval);

resetResendInterval = setInterval(() => {
seconds--;
document.getElementById('resetTimerCount').textContent = seconds;
if (seconds <= 0) {
clearInterval(resetResendInterval);
document.getElementById('resendResetBtn').classList.remove('hidden');
document.getElementById('resendResetTimer').classList.add('hidden');
}
}, 1000);
}

function resendResetOTP() {
showToast('Reset code resent to your phone');
startResetResendTimer();
}

function verifyResetOTP() {
const inputs = document.querySelectorAll('#resetOtpInputs input');
let otp = '';
inputs.forEach(input => otp += input.value);

if (otp.length !== 6) {
document.getElementById('resetOtpError').classList.remove('hidden');
return;
}

document.getElementById('resetOtpError').classList.add('hidden');
const btn = document.getElementById('verifyResetBtn');
btn.innerHTML = '<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span>Verifying...</span>';
btn.disabled = true;

setTimeout(() => {
btn.innerHTML = 'Verify code';
btn.disabled = false;
if (resetResendInterval) clearInterval(resetResendInterval);
showStep(9);
document.getElementById('newPassword').focus();
}, 1500);
}

function resetPassword() {
const newPass = document.getElementById('newPassword').value;
const confirmPass = document.getElementById('confirmNewPassword').value;

if (newPass.length < 8) {
showToast('Password must be at least 8 characters', true);
return;
}

if (newPass !== confirmPass) {
document.getElementById('newConfirmError').classList.remove('hidden');
return;
}

document.getElementById('newConfirmError').classList.add('hidden');

const btn = document.getElementById('resetPassBtn');
btn.innerHTML = '<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span>Resetting...</span>';
btn.disabled = true;

setTimeout(() => {
btn.innerHTML = 'Reset password';
btn.disabled = false;
showStep(10);
}, 1500);
}
</script>
</body>
</html>
