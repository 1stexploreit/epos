<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Dashboard - POS System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .custom-scroll::-webkit-scrollbar { width: 4px; }
    .custom-scroll::-webkit-scrollbar-track { background: transparent; }
    .custom-scroll::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 4px; }
    .custom-scroll::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
    #sidebar { transition: transform 0.3s ease-in-out; }
    @media (max-width: 1023px) {
      #sidebar { position: fixed; top: 0; left: 0; height: 100%; z-index: 50; transform: translateX(-100%); }
      #sidebar.open { transform: translateX(0); }
    }
    #overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 40; }
    #overlay.show { display: block; }
  </style>
</head>
<body class="bg-gray-100 h-screen overflow-hidden">
  <div id="overlay" onclick="closeSidebar()"></div>
  <div class="flex h-full">
    <div id="sidebar" class="w-64 bg-slate-900 flex flex-col"></div>

    <div class="flex-1 flex flex-col min-w-0">
      <div id="topbar" class="bg-white border-b px-3 md:px-6 py-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <button id="burgerBtn" class="lg:hidden p-2 text-gray-600 hover:bg-gray-100 rounded-lg" onclick="toggleSidebar()">
            <i data-lucide="menu" class="h-5 w-5"></i>
          </button>
          <div class="flex items-center gap-3 lg:hidden">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
              <i data-lucide="store" class="h-4 w-4 text-white"></i>
            </div>
            <div>
              <h1 class="font-bold text-sm text-gray-900">POS System</h1>
              <p class="text-[10px] text-gray-500">Management Panel</p>
            </div>
          </div>
          <div class="hidden lg:block">
            <h2 class="text-xl font-bold text-gray-900">Dashboard</h2>
            <p class="text-sm text-gray-500">Welcome back! Here's your store overview</p>
          </div>
        </div>
        <div class="flex items-center gap-1 sm:gap-3">
          <button class="hidden sm:flex items-center gap-1.5 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg" title="POS">
            <i data-lucide="monitor" class="h-5 w-5"></i>
            <span class="text-sm font-medium hidden md:inline">POS</span>
          </button>
          
          <div class="relative">
            <button id="quickLaunchBtn" class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg"><i data-lucide="layout-grid" class="h-5 w-5"></i></button>
            <div id="quickLaunchDropdown" class="hidden absolute right-0 top-full mt-2 w-64 bg-white border rounded-xl shadow-lg z-50 p-3">
              <p class="text-xs font-semibold text-slate-400 uppercase tracking-wide mb-3">Quick Launch</p>
              <div class="grid grid-cols-3 gap-2">
                <a href="#" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-blue-50 group"><div class="w-10 h-10 rounded-xl flex items-center justify-center bg-gradient-to-br from-blue-500 to-blue-700 shadow-lg shadow-blue-500/30"><i data-lucide="shopping-cart" class="w-5 h-5 text-white"></i></div><span class="text-[10px] font-medium text-slate-600">New Sale</span></a>
                <a href="#" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-emerald-50 group"><div class="w-10 h-10 rounded-xl flex items-center justify-center bg-gradient-to-br from-emerald-500 to-emerald-700 shadow-lg shadow-emerald-500/30"><i data-lucide="package-plus" class="w-5 h-5 text-white"></i></div><span class="text-[10px] font-medium text-slate-600">Add Product</span></a>
                <a href="#" class="flex flex-col items-center gap-1.5 p-3 rounded-xl hover:bg-purple-50 group"><div class="w-10 h-10 rounded-xl flex items-center justify-center bg-gradient-to-br from-purple-500 to-purple-700 shadow-lg shadow-purple-500/30"><i data-lucide="user-plus" class="w-5 h-5 text-white"></i></div><span class="text-[10px] font-medium text-slate-600">Customer</span></a>
              </div>
            </div>
          </div>
          <div class="relative hidden sm:block">
            <button id="langToggleBtn" class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg flex items-center gap-1.5"><i data-lucide="globe" class="h-5 w-5"></i><span class="text-xs font-medium">EN</span></button>
            <div id="langDropdown" class="hidden absolute right-0 top-full mt-2 w-40 bg-white border rounded-xl shadow-lg z-50 py-2">
              <a href="#" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-50" onclick="setLang('EN',event)"><span>ðŸ‡ºðŸ‡¸</span><span class="text-sm">English</span></a>
              <a href="#" class="flex items-center gap-3 px-4 py-2 hover:bg-gray-50" onclick="setLang('ES',event)"><span>ðŸ‡ªðŸ‡¸</span><span class="text-sm">EspaÃ±ol</span></a>
            </div>
          </div>
          <button id="themeToggle" class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg"><i data-lucide="moon" class="h-5 w-5" id="themeIcon"></i></button>
          <div class="relative">
            <button id="notificationBtn" class="relative p-2 text-gray-600 hover:bg-gray-100 rounded-lg"><i data-lucide="bell" class="h-5 w-5"></i><span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">3</span></button>
            <div id="notificationDropdown" class="hidden absolute right-0 top-full mt-2 w-72 bg-white border rounded-xl shadow-lg z-50 overflow-hidden">
              <div class="px-4 py-3 border-b flex items-center justify-between"><h3 class="text-sm font-semibold text-slate-800">Notifications</h3><span class="text-xs text-blue-600 cursor-pointer">Mark all read</span></div>
              <div class="max-h-72 overflow-y-auto">
                <div class="px-4 py-3 hover:bg-slate-50 border-b cursor-pointer"><div class="flex gap-3"><div class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></div><div><p class="text-sm text-slate-700">New order <span class="font-medium">#2847</span></p><p class="text-xs text-slate-400 mt-0.5">2 min ago</p></div></div></div>
                <div class="px-4 py-3 hover:bg-slate-50 cursor-pointer"><div class="flex gap-3"><div class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></div><div><p class="text-sm text-slate-700"><span class="font-medium">Low stock</span> alert</p><p class="text-xs text-slate-400 mt-0.5">15 min ago</p></div></div></div>
              </div>
              <div class="px-4 py-2.5 border-t bg-slate-50"><button class="w-full text-xs font-medium text-blue-600">View All</button></div>
            </div>
          </div>
          <div class="relative">
            <button id="userMenuBtn" class="flex items-center gap-2 p-2 hover:bg-gray-100 rounded-lg">
              <i data-lucide="chevron-down" class="h-4 w-4 text-gray-400 hidden sm:block"></i>
              <div class="text-right hidden md:block">
                <p class="text-sm font-medium text-gray-900">John Doe</p>
                <p class="text-xs text-gray-500">Manager</p>
              </div>
              <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                <i data-lucide="user" class="h-4 w-4 text-white"></i>
              </div>
            </button>
            <div id="userMenuDropdown" class="hidden absolute right-0 top-full mt-2 w-56 bg-white border rounded-xl shadow-lg z-50 overflow-hidden">
              <div class="p-4 border-b"><div class="flex items-center gap-3"><div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center"><i data-lucide="user" class="h-5 w-5 text-white"></i></div><div><p class="text-sm font-semibold text-slate-800">John Doe</p><p class="text-xs text-slate-400">Manager</p></div></div></div>
              <div class="py-2"><a href="#" class="flex items-center gap-3 px-4 py-2 text-sm text-slate-600 hover:bg-slate-50"><i data-lucide="user-circle" class="h-4 w-4 text-slate-400"></i>Profile</a><a href="#" class="flex items-center gap-3 px-4 py-2 text-sm text-slate-600 hover:bg-slate-50"><i data-lucide="settings" class="h-4 w-4 text-slate-400"></i>Settings</a></div>
              <div class="border-t py-2"><a href="#" class="flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50"><i data-lucide="log-out" class="h-4 w-4"></i>Logout</a></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Note Modal -->
      <div id="addNoteModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50">
        <div class="bg-white rounded-xl p-5 w-80 shadow-xl">
          <h3 class="text-sm font-semibold text-slate-800 mb-3">Add New Note</h3>
          <textarea id="newNoteText" class="w-full border rounded-lg p-3 text-sm resize-none h-24" placeholder="Enter your note..."></textarea>
          <div class="flex gap-2 mt-3">
            <button onclick="closeNoteModal()" class="flex-1 px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg">Cancel</button>
            <button onclick="saveNote()" class="flex-1 px-4 py-2 text-sm text-white bg-blue-600 hover:bg-blue-700 rounded-lg">Save</button>
          </div>
        </div>
      </div>

      <div class="flex-1 overflow-y-auto p-4 md:p-6 custom-scroll">
        <div id="statsCards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-6"></div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-5 mb-6">
          <div class="lg:col-span-8 bg-white rounded-xl border p-5">
            <div class="flex items-center justify-between mb-5">
              <div><h2 class="text-sm font-semibold text-slate-800">Sales Overview</h2><p class="text-[11px] text-slate-400">Weekly performance</p></div>
              <div class="flex gap-1 bg-slate-100 p-1 rounded-xl">
                <button class="px-4 py-1.5 text-[11px] font-medium text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg shadow-sm">Week</button>
                <button class="px-4 py-1.5 text-[11px] font-medium text-slate-500 hover:text-slate-700">Month</button>
              </div>
            </div>
            <div class="h-56"><canvas id="salesChart"></canvas></div>
          </div>
          <div class="lg:col-span-4 bg-white rounded-xl border flex flex-col" style="max-height: 340px;">
            <div class="p-4 border-b flex items-center justify-between flex-shrink-0">
              <h3 class="text-sm font-semibold text-slate-800">Wallet Balance</h3>
              <span class="text-lg font-bold text-slate-800">$271,450</span>
            </div>
            <div class="flex-1 overflow-y-auto p-4 space-y-2 custom-scroll">
              <div class="flex items-center justify-between p-3 hover:bg-slate-50 rounded-lg transition-colors">
                <div class="flex items-center gap-3">
                  <div class="w-9 h-9 rounded-lg bg-emerald-100 flex items-center justify-center"><i data-lucide="banknote" class="w-4 h-4 text-emerald-600"></i></div>
                  <div><p class="text-sm font-medium text-slate-700">Cash</p><p class="text-[10px] text-slate-400">Main drawer</p></div>
                </div>
                <span class="text-sm font-semibold text-slate-800">$125,400</span>
              </div>
              <div class="flex items-center justify-between p-3 hover:bg-slate-50 rounded-lg transition-colors">
                <div class="flex items-center gap-3">
                  <div class="w-9 h-9 rounded-lg bg-blue-100 flex items-center justify-center"><i data-lucide="credit-card" class="w-4 h-4 text-blue-600"></i></div>
                  <div><p class="text-sm font-medium text-slate-700">Visa Card</p><p class="text-[10px] text-slate-400">****4582</p></div>
                </div>
                <span class="text-sm font-semibold text-slate-800">$52,300</span>
              </div>
              <div class="flex items-center justify-between p-3 hover:bg-slate-50 rounded-lg transition-colors">
                <div class="flex items-center gap-3">
                  <div class="w-9 h-9 rounded-lg bg-orange-100 flex items-center justify-center"><i data-lucide="credit-card" class="w-4 h-4 text-orange-600"></i></div>
                  <div><p class="text-sm font-medium text-slate-700">Mastercard</p><p class="text-[10px] text-slate-400">****7891</p></div>
                </div>
                <span class="text-sm font-semibold text-slate-800">$36,950</span>
              </div>
              <div class="flex items-center justify-between p-3 hover:bg-slate-50 rounded-lg transition-colors">
                <div class="flex items-center gap-3">
                  <div class="w-9 h-9 rounded-lg bg-purple-100 flex items-center justify-center"><i data-lucide="smartphone" class="w-4 h-4 text-purple-600"></i></div>
                  <div><p class="text-sm font-medium text-slate-700">PayPal</p><p class="text-[10px] text-slate-400">store@email.com</p></div>
                </div>
                <span class="text-sm font-semibold text-slate-800">$28,400</span>
              </div>
              <div class="flex items-center justify-between p-3 hover:bg-slate-50 rounded-lg transition-colors">
                <div class="flex items-center gap-3">
                  <div class="w-9 h-9 rounded-lg bg-green-100 flex items-center justify-center"><i data-lucide="smartphone" class="w-4 h-4 text-green-600"></i></div>
                  <div><p class="text-sm font-medium text-slate-700">Apple Pay</p><p class="text-[10px] text-slate-400">Connected</p></div>
                </div>
                <span class="text-sm font-semibold text-slate-800">$15,200</span>
              </div>
              <div class="flex items-center justify-between p-3 hover:bg-slate-50 rounded-lg transition-colors">
                <div class="flex items-center gap-3">
                  <div class="w-9 h-9 rounded-lg bg-sky-100 flex items-center justify-center"><i data-lucide="landmark" class="w-4 h-4 text-sky-600"></i></div>
                  <div><p class="text-sm font-medium text-slate-700">Bank Account</p><p class="text-[10px] text-slate-400">****3421</p></div>
                </div>
                <span class="text-sm font-semibold text-slate-800">$13,200</span>
              </div>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div class="lg:col-span-2 bg-white rounded-xl border">
            <div class="p-5 border-b flex items-center justify-between flex-wrap gap-2">
              <div class="flex items-center gap-1 bg-slate-100 p-1 rounded-lg">
                <button id="tabOrders" onclick="switchTab('orders')" class="px-3 py-1.5 text-xs font-medium text-white bg-slate-800 rounded-md transition-colors">Orders</button>
                <button id="tabReceivable" onclick="switchTab('receivable')" class="px-3 py-1.5 text-xs font-medium text-slate-500 hover:text-slate-700 rounded-md transition-colors">Receivable</button>
                <button id="tabReceive" onclick="switchTab('receive')" class="px-3 py-1.5 text-xs font-medium text-slate-500 hover:text-slate-700 rounded-md transition-colors">Receive</button>
                <button id="tabPayments" onclick="switchTab('payments')" class="px-3 py-1.5 text-xs font-medium text-slate-500 hover:text-slate-700 rounded-md transition-colors">Payments</button>
              </div>
              <button class="text-blue-600 text-xs font-medium">View All</button>
            </div>
            
            <div id="ordersContent" class="overflow-x-auto">
              <table class="w-full">
                <thead class="bg-slate-50 border-b border-slate-100"><tr><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Order ID</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Customer</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Total</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Status</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Time</th></tr></thead>
                <tbody id="recentOrdersBody" class="divide-y divide-slate-100"></tbody>
              </table>
            </div>
            
            <div id="receivableContent" class="hidden overflow-x-auto">
              <table class="w-full">
                <thead class="bg-slate-50 border-b border-slate-100"><tr><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Customer</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Invoice</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Due Date</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Amount</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Status</th></tr></thead>
                <tbody id="receivableBody" class="divide-y divide-slate-100"></tbody>
              </table>
            </div>
            
            <div id="receiveContent" class="hidden overflow-x-auto">
              <table class="w-full">
                <thead class="bg-slate-50 border-b border-slate-100"><tr><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Description</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Category</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Method</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Time</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Amount</th></tr></thead>
                <tbody id="receiveBody" class="divide-y divide-slate-100"></tbody>
              </table>
            </div>
            
            <div id="paymentsContent" class="hidden overflow-x-auto">
              <table class="w-full">
                <thead class="bg-slate-50 border-b border-slate-100"><tr><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Description</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Category</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Method</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Time</th><th class="text-left p-4 text-[11px] font-semibold text-slate-500 uppercase tracking-wider">Amount</th></tr></thead>
                <tbody id="paymentsBody" class="divide-y divide-slate-100"></tbody>
              </table>
            </div>
          </div>
          <div class="space-y-5">
            <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl p-5 text-white">
              <div class="flex items-center gap-2 mb-4"><div class="w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center"><i data-lucide="wallet" class="h-4 w-4"></i></div><h3 class="font-semibold text-sm">Today Balance</h3></div>
              <div class="space-y-3">
                <div class="flex items-center justify-between text-sm"><span class="text-slate-400">Total Receive</span><span class="text-emerald-400 font-medium">+$45,200</span></div>
                <div class="flex items-center justify-between text-sm"><span class="text-slate-400">Total Payment</span><span class="text-red-400 font-medium">-$12,500</span></div>
                <div class="border-t border-slate-700 pt-3 flex items-center justify-between"><span class="text-slate-300 font-medium">Net Balance</span><span class="text-2xl font-bold">$32,700</span></div>
              </div>
            </div>
            
            <div class="bg-white rounded-xl border p-4">
              <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-2">
                  <div class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center"><i data-lucide="sticky-note" class="h-4 w-4 text-amber-600"></i></div>
                  <h3 class="font-semibold text-sm">Notes</h3>
                  <button id="addNoteBtn" class="w-6 h-6 bg-blue-600 hover:bg-blue-700 rounded-full flex items-center justify-center" title="Add Note">
                    <i data-lucide="plus" class="h-3.5 w-3.5 text-white"></i>
                  </button>
                </div>
                <div class="flex items-center gap-1">
                  <button onclick="prevNote()" class="p-1 hover:bg-slate-100 rounded transition-colors"><i data-lucide="chevron-left" class="h-4 w-4 text-slate-400"></i></button>
                  <span id="noteCounter" class="text-xs text-slate-400 px-2">1 / 4</span>
                  <button onclick="nextNote()" class="p-1 hover:bg-slate-100 rounded transition-colors"><i data-lucide="chevron-right" class="h-4 w-4 text-slate-400"></i></button>
                </div>
              </div>
              <div id="noteContent" class="min-h-16">
                <p class="text-sm text-slate-600 leading-relaxed"></p>
              </div>
              <div class="flex justify-center gap-1.5 mt-3" id="noteDots"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let isDarkTheme = true;
    let customerMenuOpen = false;

    const recentOrders = [
      { id: '#ORD-2847', customer: 'John Smith', total: 149.97, status: 'Completed', time: '10:30 AM' },
      { id: '#ORD-2846', customer: 'Emma Wilson', total: 999.99, status: 'Processing', time: '10:15 AM' },
      { id: '#ORD-2845', customer: 'Michael Brown', total: 87.45, status: 'Completed', time: '09:45 AM' },
      { id: '#ORD-2844', customer: 'Sarah Davis', total: 259.98, status: 'Pending', time: '09:30 AM' },
    ];
    const todayReceivable = [
      { customer: 'ABC Corporation', invoice: 'INV-001', dueDate: 'Today', amount: 2500, status: 'Due Today' },
      { customer: 'XYZ Ltd', invoice: 'INV-002', dueDate: 'Today', amount: 1850, status: 'Due Today' },
      { customer: 'Smith & Sons', invoice: 'INV-003', dueDate: 'Tomorrow', amount: 3200, status: 'Upcoming' },
      { customer: 'Tech Solutions', invoice: 'INV-004', dueDate: 'Dec 25', amount: 950, status: 'Upcoming' },
    ];
    const todayReceive = [
      { desc: 'Cash Sales - Walk-in', category: 'Sales', method: 'Cash', time: '10:30 AM', amount: 18500 },
      { desc: 'Card Payment - Online', category: 'Sales', method: 'Visa Card', time: '11:15 AM', amount: 15200 },
      { desc: 'Invoice #INV-098 Payment', category: 'Collection', method: 'Bank Transfer', time: '12:00 PM', amount: 8500 },
      { desc: 'Refund Return Credit', category: 'Adjustment', method: 'Cash', time: '2:30 PM', amount: 3000 },
    ];
    const todayPayments = [
      { desc: 'Supplier - Tech Distributors', category: 'Inventory', method: 'Bank Transfer', time: '9:00 AM', amount: 6500 },
      { desc: 'Monthly Salary - Staff', category: 'Payroll', method: 'Bank Transfer', time: '10:00 AM', amount: 3500 },
      { desc: 'Electricity Bill - Dec', category: 'Utilities', method: 'Online', time: '11:30 AM', amount: 1500 },
      { desc: 'Office Supplies', category: 'Operations', method: 'Cash', time: '3:00 PM', amount: 1000 },
    ];
    let notes = [
      { text: 'Remember to reorder iPhone 15 Pro cases - stock running low. Contact supplier by EOD.', date: 'Today, 9:30 AM', color: 'amber' },
      { text: 'Staff meeting scheduled for tomorrow at 10 AM. Discuss Q4 sales targets and holiday schedule.', date: 'Today, 8:15 AM', color: 'blue' },
      { text: 'New supplier contract needs review. Check terms for bulk discounts on electronics.', date: 'Yesterday', color: 'purple' },
      { text: 'Customer feedback: Need more payment options. Consider adding Apple Pay integration.', date: 'Dec 18', color: 'emerald' },
    ];
    let currentNote = 0;

    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('open');
      document.getElementById('overlay').classList.toggle('show');
    }
    function closeSidebar() {
      document.getElementById('sidebar').classList.remove('open');
      document.getElementById('overlay').classList.remove('show');
    }

    function closeNoteModal() {
      document.getElementById('addNoteModal').classList.add('hidden');
      document.getElementById('newNoteText').value = '';
    }
    function saveNote() {
      const text = document.getElementById('newNoteText').value.trim();
      if (text) {
        const now = new Date();
        const timeStr = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        notes.unshift({ text, date: 'Today, ' + timeStr, color: 'amber' });
        currentNote = 0;
        renderNotes();
        closeNoteModal();
      }
    }

    function renderNotes() {
      const note = notes[currentNote];
      document.getElementById('noteContent').innerHTML = `
        <p class="text-sm text-slate-600 leading-relaxed">${note.text}</p>
        <p class="text-xs text-slate-400 mt-2">${note.date}</p>
      `;
      document.getElementById('noteCounter').textContent = `${currentNote + 1} / ${notes.length}`;
      document.getElementById('noteDots').innerHTML = notes.map((_, i) => `
        <button onclick="goToNote(${i})" class="w-1.5 h-1.5 rounded-full transition-colors ${i === currentNote ? 'bg-slate-800' : 'bg-slate-200 hover:bg-slate-300'}"></button>
      `).join('');
    }

    function nextNote() { currentNote = (currentNote + 1) % notes.length; renderNotes(); }
    function prevNote() { currentNote = (currentNote - 1 + notes.length) % notes.length; renderNotes(); }
    function goToNote(index) { currentNote = index; renderNotes(); }

    function renderStatsCards() {
      const c = document.getElementById('statsCards');
      const iconStyle = isDarkTheme ? 'w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center' : 'w-11 h-11 rounded-xl flex items-center justify-center bg-gradient-to-br';
      c.innerHTML = `
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-5">
          <div class="flex items-start justify-between">
            <div><p class="text-xs font-medium text-slate-400 uppercase tracking-wider">Today Orders</p><p class="text-2xl font-semibold text-slate-800 mt-1">142</p></div>
            <div class="${isDarkTheme ? iconStyle : iconStyle + ' from-blue-500 to-blue-700 shadow-lg shadow-blue-500/30'}"><i data-lucide="shopping-bag" class="w-5 h-5 ${isDarkTheme ? 'text-slate-500' : 'text-white'}"></i></div>
          </div>
          <div class="mt-4 pt-4 border-t border-slate-100"><div class="flex items-center justify-between text-xs"><div class="flex items-center gap-4"><span class="text-slate-400">Online <span class="text-slate-600 font-medium">68</span></span><span class="text-slate-400">App <span class="text-slate-600 font-medium">52</span></span><span class="text-slate-400">Store <span class="text-slate-600 font-medium">22</span></span></div><span class="text-emerald-600 font-medium">+12%</span></div></div>
        </div>
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-5">
          <div class="flex items-start justify-between">
            <div><p class="text-xs font-medium text-slate-400 uppercase tracking-wider">Today Revenue</p><p class="text-2xl font-semibold text-slate-800 mt-1">$32,700</p></div>
            <div class="${isDarkTheme ? iconStyle : iconStyle + ' from-emerald-500 to-emerald-700 shadow-lg shadow-emerald-500/30'}"><i data-lucide="dollar-sign" class="w-5 h-5 ${isDarkTheme ? 'text-slate-500' : 'text-white'}"></i></div>
          </div>
          <div class="mt-4 pt-4 border-t border-slate-100"><div class="flex items-center justify-between text-xs"><div class="flex items-center gap-4"><span class="text-slate-400">In <span class="text-emerald-600 font-medium">$45,200</span></span><span class="text-slate-400">Out <span class="text-red-500 font-medium">$12,500</span></span></div><span class="text-emerald-600 font-medium">+8.5%</span></div></div>
        </div>
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-5">
          <div class="flex items-start justify-between">
            <div><p class="text-xs font-medium text-slate-400 uppercase tracking-wider">Account Balance</p><p class="text-2xl font-semibold text-slate-800 mt-1">$214,500</p></div>
            <div class="${isDarkTheme ? iconStyle : iconStyle + ' from-violet-500 to-violet-700 shadow-lg shadow-violet-500/30'}"><i data-lucide="wallet" class="w-5 h-5 ${isDarkTheme ? 'text-slate-500' : 'text-white'}"></i></div>
          </div>
          <div class="mt-4 pt-4 border-t border-slate-100"><div class="flex items-center justify-between text-xs"><span class="text-slate-400">Payable <span class="text-red-500 font-medium">$125,000</span></span><span class="text-slate-400">Receivable <span class="text-emerald-600 font-medium">$89,500</span></span></div></div>
        </div>
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 p-5">
          <div class="flex items-start justify-between">
            <div><p class="text-xs font-medium text-slate-400 uppercase tracking-wider">Inventory</p><div class="flex items-baseline gap-2 mt-1"><p class="text-2xl font-semibold text-slate-800">183,838</p><span class="text-slate-300">â€¢</span><p class="text-lg font-semibold text-emerald-600">$3,432,423</p></div></div>
            <div class="${isDarkTheme ? iconStyle : iconStyle + ' from-amber-500 to-amber-700 shadow-lg shadow-amber-500/30'}"><i data-lucide="package" class="w-5 h-5 ${isDarkTheme ? 'text-slate-500' : 'text-white'}"></i></div>
          </div>
          <div class="mt-4 pt-4 border-t border-slate-100">
            <div class="flex gap-1 h-1.5 rounded-full overflow-hidden bg-slate-100 mb-2">
              <div class="bg-emerald-500 rounded-full" style="flex:75"></div>
              <div class="bg-amber-500 rounded-full" style="flex:18"></div>
              <div class="bg-red-500 rounded-full" style="flex:7"></div>
            </div>
            <div class="flex items-center justify-between text-xs">
              <div class="flex items-center gap-3">
                <span class="flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span><span class="text-slate-400">137,878 in stock</span></span>
                <span class="flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-amber-500"></span><span class="text-slate-400">33,091 low</span></span>
                <span class="flex items-center gap-1"><span class="w-1.5 h-1.5 rounded-full bg-red-500"></span><span class="text-slate-400">12,869 out</span></span>
              </div>
            </div>
          </div>
        </div>`;
      if (typeof lucide !== 'undefined') lucide.createIcons();
    }

    function renderSidebar() {
      const s = document.getElementById('sidebar');
      if (isDarkTheme) {
        s.className = 'w-64 bg-slate-900 flex flex-col';
        s.innerHTML = `<div class="p-4 border-b border-slate-700 flex items-center justify-between"><div class="flex items-center gap-3"><div class="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center"><i data-lucide="store" class="h-6 w-6 text-white"></i></div><div><h1 class="font-bold text-lg text-white">POS System</h1><p class="text-xs text-slate-400">Management Panel</p></div></div><button class="lg:hidden p-1 text-slate-400 hover:text-white" onclick="closeSidebar()"><i data-lucide="x" class="h-5 w-5"></i></button></div>
          <nav class="flex-1 p-4 space-y-2 overflow-y-auto custom-scroll">
            <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3">Main Menu</div>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg bg-blue-600 text-white"><i data-lucide="layout-dashboard" class="h-5 w-5"></i><span class="text-sm font-medium">Dashboard</span></a>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-800"><i data-lucide="package" class="h-5 w-5 text-slate-400"></i><span class="text-sm font-medium">Products</span><span class="ml-auto bg-slate-700 text-xs px-2 py-0.5 rounded-full">36</span></a>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-800"><i data-lucide="shopping-cart" class="h-5 w-5 text-slate-400"></i><span class="text-sm font-medium">Orders</span></a>
            <div class="customer-menu">
              <a href="#" onclick="toggleCustomerMenu(event)" class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-800"><i data-lucide="users" class="h-5 w-5 text-slate-400"></i><span class="text-sm font-medium">Customers</span><i data-lucide="chevron-down" class="h-4 w-4 ml-auto text-slate-400 transition-transform" id="customerArrowDark"></i></a>
              <div id="customerSubmenuDark" class="hidden ml-4 pl-4 border-l border-slate-700 mt-1 space-y-1">
                <a href="#" class="flex items-center px-3 py-1.5 rounded-lg text-slate-400 hover:bg-slate-800 hover:text-slate-200 text-sm">All Customers</a>
                <a href="#" class="flex items-center px-3 py-1.5 rounded-lg text-slate-400 hover:bg-slate-800 hover:text-slate-200 text-sm">Add Customer</a>
                <a href="#" class="flex items-center px-3 py-1.5 rounded-lg text-slate-400 hover:bg-slate-800 hover:text-slate-200 text-sm">Customer Groups</a>
                <a href="#" class="flex items-center px-3 py-1.5 rounded-lg text-slate-400 hover:bg-slate-800 hover:text-slate-200 text-sm">Loyalty Program</a>
              </div>
            </div>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-800"><i data-lucide="bar-chart-3" class="h-5 w-5 text-slate-400"></i><span class="text-sm font-medium">Analytics</span></a>
            <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3 mt-6">Inventory</div>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-800"><i data-lucide="tags" class="h-5 w-5 text-slate-400"></i><span class="text-sm font-medium">Categories</span></a>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-800"><i data-lucide="warehouse" class="h-5 w-5 text-slate-400"></i><span class="text-sm font-medium">Stock Management</span></a>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-800"><i data-lucide="truck" class="h-5 w-5 text-slate-400"></i><span class="text-sm font-medium">Suppliers</span></a>
            <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3 mt-6">Settings</div>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg text-slate-300 hover:bg-slate-800"><i data-lucide="settings" class="h-5 w-5 text-slate-400"></i><span class="text-sm font-medium">System Settings</span></a>
          </nav>
          <div class="p-4 border-t border-slate-700"><div class="flex items-center gap-3"><div class="w-8 h-8 bg-emerald-500/20 rounded-lg flex items-center justify-center"><i data-lucide="map-pin" class="h-4 w-4 text-emerald-400"></i></div><div><p class="text-sm font-medium text-white">Main Branch</p><p class="text-xs text-slate-400">Downtown, New York</p></div><div class="ml-auto w-2 h-2 bg-emerald-500 rounded-full"></div></div></div>`;
      } else {
        s.className = 'w-64 bg-white border-r flex flex-col';
        s.innerHTML = `<div class="p-4 border-b flex items-center justify-between"><div class="flex items-center gap-3"><div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center"><i data-lucide="store" class="h-6 w-6 text-white"></i></div><div><h1 class="font-bold text-lg">POS System</h1><p class="text-xs text-gray-500">Management Panel</p></div></div><button class="lg:hidden p-1 text-gray-400 hover:text-gray-600" onclick="closeSidebar()"><i data-lucide="x" class="h-5 w-5"></i></button></div>
          <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
            <div class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">Main Menu</div>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg bg-blue-600 text-white"><i data-lucide="layout-dashboard" class="h-5 w-5"></i><span class="text-sm font-medium">Dashboard</span></a>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100"><i data-lucide="package" class="h-5 w-5 text-gray-600"></i><span class="text-sm font-medium">Products</span><span class="ml-auto bg-gray-100 text-xs px-2 py-0.5 rounded-full">36</span></a>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100"><i data-lucide="shopping-cart" class="h-5 w-5 text-gray-600"></i><span class="text-sm font-medium">Orders</span></a>
            <div class="customer-menu">
              <a href="#" onclick="toggleCustomerMenu(event)" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100"><i data-lucide="users" class="h-5 w-5 text-gray-600"></i><span class="text-sm font-medium">Customers</span><i data-lucide="chevron-down" class="h-4 w-4 ml-auto text-gray-400 transition-transform" id="customerArrowLight"></i></a>
              <div id="customerSubmenuLight" class="hidden ml-4 pl-4 border-l border-gray-200 mt-1 space-y-1">
                <a href="#" class="flex items-center px-3 py-1.5 rounded-lg text-gray-600 hover:bg-gray-100 text-sm">All Customers</a>
                <a href="#" class="flex items-center px-3 py-1.5 rounded-lg text-gray-600 hover:bg-gray-100 text-sm">Add Customer</a>
                <a href="#" class="flex items-center px-3 py-1.5 rounded-lg text-gray-600 hover:bg-gray-100 text-sm">Customer Groups</a>
                <a href="#" class="flex items-center px-3 py-1.5 rounded-lg text-gray-600 hover:bg-gray-100 text-sm">Loyalty Program</a>
              </div>
            </div>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100"><i data-lucide="bar-chart-3" class="h-5 w-5 text-gray-600"></i><span class="text-sm font-medium">Analytics</span></a>
            <div class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3 mt-6">Inventory</div>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100"><i data-lucide="tags" class="h-5 w-5 text-gray-600"></i><span class="text-sm font-medium">Categories</span></a>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100"><i data-lucide="warehouse" class="h-5 w-5 text-gray-600"></i><span class="text-sm font-medium">Stock Management</span></a>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100"><i data-lucide="truck" class="h-5 w-5 text-gray-600"></i><span class="text-sm font-medium">Suppliers</span></a>
            <div class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3 mt-6">Settings</div>
            <a href="#" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-100"><i data-lucide="settings" class="h-5 w-5 text-gray-600"></i><span class="text-sm font-medium">System Settings</span></a>
          </nav>
          <div class="p-4 border-t"><div class="flex items-center gap-3"><div class="w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center"><i data-lucide="map-pin" class="h-4 w-4 text-emerald-600"></i></div><div><p class="text-sm font-medium">Main Branch</p><p class="text-xs text-gray-500">Downtown, New York</p></div><div class="ml-auto w-2 h-2 bg-emerald-500 rounded-full"></div></div></div>`;
      }
      // Restore sidebar classes for responsive
      s.classList.add('lg:translate-x-0');
      if (typeof lucide !== 'undefined') lucide.createIcons();
      if (customerMenuOpen) {
        const submenu = document.getElementById(isDarkTheme ? 'customerSubmenuDark' : 'customerSubmenuLight');
        const arrow = document.getElementById(isDarkTheme ? 'customerArrowDark' : 'customerArrowLight');
        if (submenu) submenu.classList.remove('hidden');
        if (arrow) arrow.style.transform = 'rotate(180deg)';
      }
    }

    function toggleCustomerMenu(e) {
      e.preventDefault();
      customerMenuOpen = !customerMenuOpen;
      const submenu = document.getElementById(isDarkTheme ? 'customerSubmenuDark' : 'customerSubmenuLight');
      const arrow = document.getElementById(isDarkTheme ? 'customerArrowDark' : 'customerArrowLight');
      if (customerMenuOpen) { submenu.classList.remove('hidden'); arrow.style.transform = 'rotate(180deg)'; }
      else { submenu.classList.add('hidden'); arrow.style.transform = 'rotate(0deg)'; }
    }

    function toggleTheme() {
      isDarkTheme = !isDarkTheme;
      renderSidebar();
      renderStatsCards();
      updateTopbar();
      document.getElementById('themeIcon').setAttribute('data-lucide', isDarkTheme ? 'moon' : 'sun');
      if (typeof lucide !== 'undefined') lucide.createIcons();
    }

    function updateTopbar() {
      const topbar = document.getElementById('topbar');
      const isMobile = window.innerWidth < 1024;
      const shopName = topbar.querySelector('.lg\\:hidden h1');
      const shopDesc = topbar.querySelector('.lg\\:hidden p');
      
      if (isDarkTheme && isMobile) {
        topbar.className = 'bg-slate-900 border-b border-slate-700 px-3 md:px-6 py-3 flex items-center justify-between';
        topbar.querySelector('#burgerBtn').className = 'lg:hidden p-2 text-slate-300 hover:bg-slate-800 rounded-lg';
        if (shopName) shopName.className = 'font-bold text-sm text-white';
        if (shopDesc) shopDesc.className = 'text-[10px] text-slate-400';
        topbar.querySelector('#quickLaunchBtn').className = 'p-2 text-slate-300 hover:bg-slate-800 rounded-lg';
        topbar.querySelector('#themeToggle').className = 'p-2 text-slate-300 hover:bg-slate-800 rounded-lg';
        topbar.querySelector('#notificationBtn').className = 'relative p-2 text-slate-300 hover:bg-slate-800 rounded-lg';
        topbar.querySelector('#userMenuBtn').className = 'flex items-center gap-2 p-2 hover:bg-slate-800 rounded-lg';
      } else {
        topbar.className = 'bg-white border-b px-3 md:px-6 py-3 flex items-center justify-between';
        topbar.querySelector('#burgerBtn').className = 'lg:hidden p-2 text-gray-600 hover:bg-gray-100 rounded-lg';
        if (shopName) shopName.className = 'font-bold text-sm text-gray-900';
        if (shopDesc) shopDesc.className = 'text-[10px] text-gray-500';
        topbar.querySelector('#quickLaunchBtn').className = 'p-2 text-gray-600 hover:bg-gray-100 rounded-lg';
        topbar.querySelector('#themeToggle').className = 'p-2 text-gray-600 hover:bg-gray-100 rounded-lg';
        topbar.querySelector('#notificationBtn').className = 'relative p-2 text-gray-600 hover:bg-gray-100 rounded-lg';
        topbar.querySelector('#userMenuBtn').className = 'flex items-center gap-2 p-2 hover:bg-gray-100 rounded-lg';
      }
    }

    function renderRecentOrders() {
      document.getElementById('recentOrdersBody').innerHTML = recentOrders.map(o => {
        const sc = o.status === 'Completed' ? 'bg-emerald-50 text-emerald-700' : o.status === 'Processing' ? 'bg-blue-50 text-blue-700' : 'bg-amber-50 text-amber-700';
        return `<tr class="hover:bg-slate-50 transition-colors">
          <td class="p-4"><span class="text-sm font-semibold text-blue-600">${o.id}</span></td>
          <td class="p-4"><div class="flex items-center gap-3"><div class="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center"><span class="text-xs font-medium text-slate-600">${o.customer.split(' ').map(n=>n[0]).join('')}</span></div><span class="text-sm font-medium text-slate-700">${o.customer}</span></div></td>
          <td class="p-4"><span class="text-sm font-semibold text-slate-800">${o.total.toFixed(2)}</span></td>
          <td class="p-4"><span class="px-2.5 py-1 rounded-full text-[11px] font-medium ${sc}">${o.status}</span></td>
          <td class="p-4"><span class="text-sm text-slate-500">${o.time}</span></td>
        </tr>`;
      }).join('');
    }

    function renderReceivable() {
      document.getElementById('receivableBody').innerHTML = todayReceivable.map(r => {
        const dueCls = r.dueDate === 'Today' ? 'bg-red-50 text-red-700' : r.dueDate === 'Tomorrow' ? 'bg-amber-50 text-amber-700' : 'bg-slate-50 text-slate-600';
        return `<tr class="hover:bg-slate-50 transition-colors">
          <td class="p-4"><div class="flex items-center gap-3"><div class="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center"><span class="text-xs font-medium text-slate-600">${r.customer.split(' ').map(n=>n[0]).join('').slice(0,2)}</span></div><span class="text-sm font-medium text-slate-700">${r.customer}</span></div></td>
          <td class="p-4"><span class="text-sm font-medium text-blue-600">${r.invoice}</span></td>
          <td class="p-4"><span class="text-sm text-slate-600">${r.dueDate}</span></td>
          <td class="p-4"><span class="text-sm font-semibold text-slate-800">${r.amount.toLocaleString()}</span></td>
          <td class="p-4"><span class="px-2.5 py-1 rounded-full text-[11px] font-medium ${dueCls}">${r.status}</span></td>
        </tr>`;
      }).join('');
    }

    function renderReceiveTable() {
      document.getElementById('receiveBody').innerHTML = todayReceive.map(r => {
        const catCls = r.category === 'Sales' ? 'bg-emerald-50 text-emerald-700' : r.category === 'Collection' ? 'bg-blue-50 text-blue-700' : 'bg-purple-50 text-purple-700';
        return `<tr class="hover:bg-slate-50 transition-colors">
          <td class="p-4"><span class="text-sm font-medium text-slate-700">${r.desc}</span></td>
          <td class="p-4"><span class="px-2.5 py-1 rounded-full text-[11px] font-medium ${catCls}">${r.category}</span></td>
          <td class="p-4"><span class="text-sm text-slate-500">${r.method}</span></td>
          <td class="p-4"><span class="text-sm text-slate-500">${r.time}</span></td>
          <td class="p-4"><span class="text-sm font-semibold text-emerald-600">+${r.amount.toLocaleString()}</span></td>
        </tr>`;
      }).join('');
    }

    function renderPaymentsTable() {
      document.getElementById('paymentsBody').innerHTML = todayPayments.map(p => {
        const catCls = p.category === 'Inventory' ? 'bg-orange-50 text-orange-700' : p.category === 'Payroll' ? 'bg-violet-50 text-violet-700' : p.category === 'Utilities' ? 'bg-cyan-50 text-cyan-700' : 'bg-slate-50 text-slate-600';
        return `<tr class="hover:bg-slate-50 transition-colors">
          <td class="p-4"><span class="text-sm font-medium text-slate-700">${p.desc}</span></td>
          <td class="p-4"><span class="px-2.5 py-1 rounded-full text-[11px] font-medium ${catCls}">${p.category}</span></td>
          <td class="p-4"><span class="text-sm text-slate-500">${p.method}</span></td>
          <td class="p-4"><span class="text-sm text-slate-500">${p.time}</span></td>
          <td class="p-4"><span class="text-sm font-semibold text-red-500">-${p.amount.toLocaleString()}</span></td>
        </tr>`;
      }).join('');
    }

    function switchTab(tab) {
      const tabs = ['Orders', 'Receivable', 'Receive', 'Payments'];
      const contents = ['ordersContent', 'receivableContent', 'receiveContent', 'paymentsContent'];
      const tabInfo = {
        orders: { title: 'Today Orders', subtitle: 'All orders placed today', icon: 'shopping-bag', bgColor: 'bg-blue-100', iconColor: 'text-blue-600' },
        receivable: { title: 'Receivable Today', subtitle: 'Payments due today and upcoming', icon: 'file-text', bgColor: 'bg-amber-100', iconColor: 'text-amber-600' },
        receive: { title: 'Received Today', subtitle: 'All income received today', icon: 'arrow-down-circle', bgColor: 'bg-emerald-100', iconColor: 'text-emerald-600' },
        payments: { title: 'Payments Today', subtitle: 'All expenses paid today', icon: 'arrow-up-circle', bgColor: 'bg-red-100', iconColor: 'text-red-500' }
      };
      
      const titleEl = document.getElementById('tableTitle');
      const subtitleEl = document.getElementById('tableSubtitle');
      const iconEl = document.getElementById('tableIcon');
      
      if (titleEl) titleEl.textContent = tabInfo[tab].title;
      if (subtitleEl) subtitleEl.textContent = tabInfo[tab].subtitle;
      if (iconEl) {
        iconEl.className = `w-9 h-9 rounded-lg ${tabInfo[tab].bgColor} flex items-center justify-center`;
        iconEl.innerHTML = `<i data-lucide="${tabInfo[tab].icon}" class="w-4 h-4 ${tabInfo[tab].iconColor}"></i>`;
        if (typeof lucide !== 'undefined') lucide.createIcons();
      }
      
      tabs.forEach((t, i) => {
        const tabBtn = document.getElementById('tab' + t);
        const content = document.getElementById(contents[i]);
        if (t.toLowerCase() === tab) {
          tabBtn.className = 'px-3 py-1.5 text-xs font-medium text-white bg-slate-800 rounded-md transition-colors';
          content.classList.remove('hidden');
        } else {
          tabBtn.className = 'px-3 py-1.5 text-xs font-medium text-slate-500 hover:text-slate-700 rounded-md transition-colors';
          content.classList.add('hidden');
        }
      });
    }

    function initCharts() {
      const ctx = document.getElementById('salesChart').getContext('2d');
      const gradient = ctx.createLinearGradient(0, 0, 0, 200);
      gradient.addColorStop(0, 'rgba(59, 130, 246, 0.3)');
      gradient.addColorStop(1, 'rgba(59, 130, 246, 0.01)');
      new Chart(ctx, {
        type: 'line',
        data: { labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'], datasets: [{ data: [4200, 3800, 5100, 4600, 6200, 7800, 5400], backgroundColor: gradient, borderColor: '#3B82F6', borderWidth: 3, fill: true, tension: 0.4, pointBackgroundColor: '#fff', pointBorderColor: '#3B82F6', pointBorderWidth: 2, pointRadius: 4 }] },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true, grid: { color: '#f1f5f9' } }, x: { grid: { display: false } } } }
      });
    }

    function setLang(l, e) { e.preventDefault(); document.querySelector('#langToggleBtn span').textContent = l; document.getElementById('langDropdown').classList.add('hidden'); }

    document.addEventListener('DOMContentLoaded', () => {
      renderSidebar();
      renderStatsCards();
      renderRecentOrders();
      renderReceivable();
      renderReceiveTable();
      renderPaymentsTable();
      renderNotes();
      initCharts();
      if (typeof lucide !== 'undefined') lucide.createIcons();
      
      // Add note button listener after icons are created
      setTimeout(() => {
        const addNoteBtn = document.getElementById('addNoteBtn');
        if (addNoteBtn) {
          addNoteBtn.addEventListener('click', () => {
            document.getElementById('addNoteModal').classList.remove('hidden');
          });
        }
      }, 100);

      // Update topbar on resize
      window.addEventListener('resize', updateTopbar);

      document.getElementById('themeToggle').addEventListener('click', toggleTheme);
      
      ['quickLaunchBtn', 'langToggleBtn', 'notificationBtn', 'userMenuBtn'].forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.addEventListener('click', e => {
            e.stopPropagation();
            const map = { quickLaunchBtn: 'quickLaunchDropdown', langToggleBtn: 'langDropdown', notificationBtn: 'notificationDropdown', userMenuBtn: 'userMenuDropdown' };
            const currentDropdown = document.getElementById(map[id]);
            const isHidden = currentDropdown.classList.contains('hidden');
            Object.values(map).forEach(d => { const dd = document.getElementById(d); if(dd) dd.classList.add('hidden'); });
            if (isHidden) currentDropdown.classList.remove('hidden');
          });
        }
      });
      
      document.addEventListener('click', () => {
        ['quickLaunchDropdown', 'langDropdown', 'notificationDropdown', 'userMenuDropdown'].forEach(id => { const el = document.getElementById(id); if(el) el.classList.add('hidden'); });
      });
    });
  </script>
</body>
</html>