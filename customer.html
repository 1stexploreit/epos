<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customers - FreshMart POS</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{font-family:'Inter',sans-serif}
input:focus,select:focus,textarea:focus{outline:none;border-color:#10b981;box-shadow:0 0 0 3px rgba(16,185,129,0.1)}
@keyframes fadeIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideIn{from{opacity:0;transform:scale(0.95)}to{opacity:1;transform:scale(1)}}
.animate-modal{animation:slideIn 0.2s ease-out}
.toast{animation:fadeIn 0.3s ease-out}
</style>
</head>
<body class="bg-slate-100 min-h-screen">



<!-- Top Action Bar -->
<div class="bg-white border-b border-slate-200">
<div class="max-w-7xl mx-auto px-6 py-3 flex items-center justify-between">
<div>
<h1 class="text-slate-800 font-semibold">Customers</h1>
<p class="text-xs text-slate-400">Manage your customer database</p>
</div>
<div class="flex items-center gap-2">
<button onclick="exportData()" class="px-3 py-2 text-sm text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg font-medium flex items-center gap-2"><svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>Export</button>
<button onclick="openModal()" class="px-4 py-2 text-sm bg-gradient-to-r from-emerald-500 to-emerald-600 text-white rounded-lg font-medium shadow-sm hover:shadow flex items-center gap-2"><svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/></svg>Add Customer</button>
</div>
</div>
</div>

<main class="max-w-7xl mx-auto px-6 py-5 space-y-4">

<!-- Stats Cards -->
<div class="grid grid-cols-2 md:grid-cols-4 gap-4">
<div class="bg-white rounded-xl shadow-sm border border-slate-200/80 p-4">
<div class="flex items-center justify-between">
<div>
<p class="text-[10px] text-slate-400 uppercase tracking-wider font-medium">Total Customers</p>
<p class="text-xl font-bold text-slate-800 mt-1" id="statTotal">0</p>
</div>
<div class="w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center"><svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/></svg></div>
</div>
</div>
<div class="bg-white rounded-xl shadow-sm border border-slate-200/80 p-4">
<div class="flex items-center justify-between">
<div>
<p class="text-[10px] text-slate-400 uppercase tracking-wider font-medium">Active</p>
<p class="text-xl font-bold text-emerald-600 mt-1" id="statActive">0</p>
</div>
<div class="w-10 h-10 rounded-lg bg-emerald-50 flex items-center justify-center"><svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div>
</div>
</div>
<div class="bg-white rounded-xl shadow-sm border border-slate-200/80 p-4">
<div class="flex items-center justify-between">
<div>
<p class="text-[10px] text-slate-400 uppercase tracking-wider font-medium">Inactive</p>
<p class="text-xl font-bold text-slate-500 mt-1" id="statInactive">0</p>
</div>
<div class="w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center"><svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/></svg></div>
</div>
</div>
<div class="bg-white rounded-xl shadow-sm border border-slate-200/80 p-4">
<div class="flex items-center justify-between">
<div>
<p class="text-[10px] text-slate-400 uppercase tracking-wider font-medium">This Month</p>
<p class="text-xl font-bold text-amber-500 mt-1" id="statNew">0</p>
</div>
<div class="w-10 h-10 rounded-lg bg-amber-50 flex items-center justify-center"><svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div>
</div>
</div>
</div>

<!-- Search & Filter Bar -->
<div class="bg-white rounded-xl shadow-sm border border-slate-200/80 p-3">
<div class="flex flex-col md:flex-row gap-2">
<div class="flex-1 relative">
<svg class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
<input type="text" id="search" placeholder="Search by name, email, phone, or NID..." class="w-full pl-9 pr-4 py-2 border border-slate-200 rounded-lg text-xs" oninput="renderTable()">
</div>
<div class="flex gap-2">
<select id="filterStatus" class="px-3 py-2 border border-slate-200 rounded-lg text-xs text-slate-600 min-w-[110px]" onchange="renderTable()">
<option value="">All Status</option>
<option value="Active">Active</option>
<option value="Inactive">Inactive</option>
</select>
<select id="filterSort" class="px-3 py-2 border border-slate-200 rounded-lg text-xs text-slate-600 min-w-[130px]" onchange="renderTable()">
<option value="newest">Newest First</option>
<option value="oldest">Oldest First</option>
<option value="name">Name A-Z</option>
<option value="name-desc">Name Z-A</option>
<option value="balance">Highest Balance</option>
</select>
</div>
</div>
</div>

<!-- Customer Table -->
<div class="bg-white rounded-xl shadow-sm border border-slate-200/80 overflow-hidden">
<table class="w-full">
<thead class="bg-slate-50 border-b border-slate-200">
<tr class="text-[10px] text-slate-500 uppercase tracking-wider">
<th class="px-5 py-3 text-left font-semibold">Customer</th>
<th class="px-5 py-3 text-left font-semibold">Contact</th>
<th class="px-5 py-3 text-left font-semibold">NID</th>
<th class="px-5 py-3 text-right font-semibold">Balance</th>
<th class="px-5 py-3 text-center font-semibold">Status</th>
<th class="px-5 py-3 text-right font-semibold">Actions</th>
</tr>
</thead>
<tbody id="tableBody" class="divide-y divide-slate-100"></tbody>
</table>
<div id="emptyState" class="p-12 text-center" style="display:none">
<div class="w-16 h-16 mx-auto bg-slate-100 rounded-full flex items-center justify-center mb-4"><svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"/></svg></div>
<p class="text-slate-600 font-medium">No customers found</p>
<p class="text-sm text-slate-400 mt-1">Try adjusting your search or filters</p>
</div>
<!-- Pagination -->
<div class="px-5 py-3 border-t border-slate-200 flex items-center justify-between bg-slate-50/50">
<p class="text-xs text-slate-500">Showing <span id="showCount" class="font-medium text-slate-700">0</span> of <span id="totalCount" class="font-medium text-slate-700">0</span> customers</p>
<div class="flex items-center gap-1">
<button onclick="changePage(-1)" class="p-1.5 text-slate-400 hover:text-slate-600 hover:bg-white rounded-lg disabled:opacity-40" id="prevBtn"><svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/></svg></button>
<span class="px-2 py-1 text-xs text-slate-600" id="pageInfo">1 / 1</span>
<button onclick="changePage(1)" class="p-1.5 text-slate-400 hover:text-slate-600 hover:bg-white rounded-lg disabled:opacity-40" id="nextBtn"><svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/></svg></button>
</div>
</div>
</div>
</main>

<!-- Toast -->
<div id="toast" class="fixed top-4 right-4 z-50 px-4 py-3 bg-slate-800 text-white text-sm rounded-lg shadow-lg flex items-center gap-2 toast" style="display:none">
<svg class="w-5 h-5 text-emerald-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/></svg>
<span id="toastMsg">Saved successfully</span>
</div>

<!-- Add/Edit Modal -->
<div id="modal" class="fixed inset-0 z-50 flex items-center justify-center p-4" style="display:none">
<div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm" onclick="closeModal()"></div>
<div class="relative bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden animate-modal">
<div class="px-6 py-4 border-b border-slate-200 flex items-center justify-between">
<h2 id="modalTitle" class="font-semibold text-slate-800">Add Customer</h2>
<button onclick="closeModal()" class="p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg"><svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg></button>
</div>

<!-- Tabs -->
<div id="tabs" class="flex border-b border-slate-200 bg-slate-50/50">
<button onclick="switchTab('single')" id="tabSingle" class="px-6 py-3 text-sm font-semibold text-emerald-600 border-b-2 border-emerald-600 bg-white -mb-px">Single Add</button>
<button onclick="switchTab('multi')" id="tabMulti" class="px-6 py-3 text-sm font-medium text-slate-500 border-b-2 border-transparent hover:text-slate-700">Multi-Add</button>
</div>

<div class="p-6 overflow-y-auto max-h-[60vh]">
<!-- Single Form -->
<div id="singleForm">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div><label class="text-xs text-slate-500 font-semibold uppercase tracking-wider">Full Name *</label><input type="text" id="inpName" placeholder="e.g., John Doe" class="w-full mt-1.5 px-4 py-2.5 border border-slate-200 rounded-lg text-sm"></div>
<div><label class="text-xs text-slate-500 font-semibold uppercase tracking-wider">Email</label><input type="email" id="inpEmail" placeholder="e.g., john@email.com" class="w-full mt-1.5 px-4 py-2.5 border border-slate-200 rounded-lg text-sm"></div>
<div><label class="text-xs text-slate-500 font-semibold uppercase tracking-wider">Primary Phone *</label><input type="tel" id="inpPhone" placeholder="e.g., +880 1XXX XXXXXX" class="w-full mt-1.5 px-4 py-2.5 border border-slate-200 rounded-lg text-sm"></div>
<div><label class="text-xs text-slate-500 font-semibold uppercase tracking-wider">Secondary Phone</label><input type="tel" id="inpPhone2" placeholder="e.g., +880 1XXX XXXXXX" class="w-full mt-1.5 px-4 py-2.5 border border-slate-200 rounded-lg text-sm"></div>
<div><label class="text-xs text-slate-500 font-semibold uppercase tracking-wider">NID Number</label><input type="text" id="inpNid" placeholder="e.g., 1234567890123" class="w-full mt-1.5 px-4 py-2.5 border border-slate-200 rounded-lg text-sm"></div>
<div><label class="text-xs text-slate-500 font-semibold uppercase tracking-wider">Status</label><select id="inpStatus" class="w-full mt-1.5 px-4 py-2.5 border border-slate-200 rounded-lg text-sm"><option value="Active">Active</option><option value="Inactive">Inactive</option></select></div>
<div class="md:col-span-2"><label class="text-xs text-slate-500 font-semibold uppercase tracking-wider">Address</label><textarea id="inpAddress" rows="2" placeholder="e.g., 123 Main St, City, Country" class="w-full mt-1.5 px-4 py-2.5 border border-slate-200 rounded-lg text-sm resize-none"></textarea></div>
</div>
</div>

<!-- Multi Form -->
<div id="multiForm" style="display:none">
<div class="space-y-3" id="multiRows"></div>
<button onclick="addMultiRow()" class="mt-4 w-full py-3 border-2 border-dashed border-slate-300 rounded-lg text-sm font-medium text-slate-500 hover:border-emerald-400 hover:text-emerald-600 flex items-center justify-center gap-2 transition-colors">
<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/></svg>
Add Another Row
</button>
</div>
</div>

<div class="px-6 py-4 border-t border-slate-200 flex justify-end gap-3 bg-slate-50">
<button onclick="closeModal()" class="px-5 py-2.5 text-sm text-slate-600 bg-white border border-slate-200 hover:bg-slate-50 rounded-lg font-medium">Cancel</button>
<button onclick="saveCustomer()" class="px-5 py-2.5 text-sm bg-gradient-to-r from-emerald-500 to-emerald-600 text-white rounded-lg font-medium shadow-sm">Save Customer</button>
</div>
</div>
</div>

<!-- Delete Modal -->
<div id="deleteModal" class="fixed inset-0 z-50 flex items-center justify-center p-4" style="display:none">
<div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm" onclick="closeDeleteModal()"></div>
<div class="relative bg-white rounded-xl shadow-2xl w-full max-w-sm p-6 animate-modal">
<div class="text-center">
<div class="w-14 h-14 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4">
<svg class="w-7 h-7 text-red-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
</div>
<h3 class="text-lg font-semibold text-slate-800 mb-2">Delete Customer?</h3>
<p class="text-sm text-slate-500 mb-6">This action cannot be undone. All customer data will be permanently removed.</p>
<div class="flex gap-3">
<button onclick="closeDeleteModal()" class="flex-1 px-4 py-2.5 text-sm text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-lg font-medium">Cancel</button>
<button onclick="confirmDelete()" class="flex-1 px-4 py-2.5 text-sm bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium">Delete</button>
</div>
</div>
</div>
</div>

<script>
let customers = [
{id:1,name:"Sarah Johnson",email:"sarah.j@email.com",phone:"+880 1711 234567",phone2:"+880 1911 234567",nid:"1234567890123",address:"456 Oak Avenue, Dhaka",status:"Active",balance:1250,created:new Date()},
{id:2,name:"Michael Chen",email:"m.chen@email.com",phone:"+880 1812 345678",phone2:"",nid:"2345678901234",address:"789 Pine Street, Chittagong",status:"Active",balance:0,created:new Date()},
{id:3,name:"Emma Williams",email:"emma.w@email.com",phone:"+880 1912 456789",phone2:"",nid:"3456789012345",address:"321 Maple Drive, Sylhet",status:"Inactive",balance:520,created:new Date(Date.now()-40*24*60*60*1000)},
{id:4,name:"James Rodriguez",email:"james.r@email.com",phone:"+880 1612 567890",phone2:"+880 1712 567890",nid:"4567890123456",address:"654 Cedar Lane, Rajshahi",status:"Active",balance:3200,created:new Date()},
{id:5,name:"Aisha Rahman",email:"aisha.r@email.com",phone:"+880 1512 678901",phone2:"",nid:"5678901234567",address:"987 Birch Road, Khulna",status:"Active",balance:890,created:new Date()},
{id:6,name:"David Kim",email:"david.k@email.com",phone:"+880 1812 789012",phone2:"",nid:"6789012345678",address:"147 Elm Street, Dhaka",status:"Inactive",balance:0,created:new Date(Date.now()-60*24*60*60*1000)},
];

let editId=null,deleteId=null,currentTab='single',currentPage=1,perPage=10;

const fmt=n=>'$'+n.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,'$&,');

function showToast(msg){
const t=document.getElementById('toast');
document.getElementById('toastMsg').textContent=msg;
t.style.display='flex';
setTimeout(()=>t.style.display='none',3000);
}

function updateStats(){
const now=new Date(),month=now.getMonth(),year=now.getFullYear();
const active=customers.filter(c=>c.status==='Active').length;
const newMonth=customers.filter(c=>{const d=new Date(c.created);return d.getMonth()===month&&d.getFullYear()===year;}).length;
document.getElementById('statTotal').textContent=customers.length;
document.getElementById('statActive').textContent=active;
document.getElementById('statInactive').textContent=customers.length-active;
document.getElementById('statNew').textContent=newMonth;
}

function getFiltered(){
const search=document.getElementById('search').value.toLowerCase();
const status=document.getElementById('filterStatus').value;
const sort=document.getElementById('filterSort').value;
let list=customers.filter(c=>{
const match=c.name.toLowerCase().includes(search)||c.email.toLowerCase().includes(search)||c.phone.includes(search)||c.nid.includes(search);
return match&&(!status||c.status===status);
});
if(sort==='newest')list.sort((a,b)=>new Date(b.created)-new Date(a.created));
else if(sort==='oldest')list.sort((a,b)=>new Date(a.created)-new Date(b.created));
else if(sort==='name')list.sort((a,b)=>a.name.localeCompare(b.name));
else if(sort==='name-desc')list.sort((a,b)=>b.name.localeCompare(a.name));
else if(sort==='balance')list.sort((a,b)=>b.balance-a.balance);
return list;
}

function renderTable(){
const filtered=getFiltered();
const totalPages=Math.ceil(filtered.length/perPage)||1;
if(currentPage>totalPages)currentPage=totalPages;
const start=(currentPage-1)*perPage;
const paged=filtered.slice(start,start+perPage);

document.getElementById('totalCount').textContent=filtered.length;
document.getElementById('showCount').textContent=paged.length;
document.getElementById('pageInfo').textContent=currentPage+' / '+totalPages;
document.getElementById('prevBtn').disabled=currentPage===1;
document.getElementById('nextBtn').disabled=currentPage===totalPages;

if(!filtered.length){
document.getElementById('tableBody').innerHTML='';
document.getElementById('emptyState').style.display='block';
return;
}
document.getElementById('emptyState').style.display='none';
document.getElementById('tableBody').innerHTML=paged.map(c=>`
<tr class="hover:bg-slate-50/80 text-[13px]">
<td class="px-5 py-3">
<div class="flex items-center gap-3">
<div class="w-9 h-9 rounded-lg bg-gradient-to-br from-emerald-400 to-emerald-600 flex items-center justify-center text-white font-semibold text-xs shadow-sm">${c.name.split(' ').map(n=>n[0]).join('').slice(0,2)}</div>
<div>
<a href="#" onclick="viewProfile(${c.id})" class="font-semibold text-slate-800 hover:text-emerald-600">${c.name}</a>
<p class="text-[11px] text-slate-400">#${String(c.id).padStart(4,'0')}</p>
</div>
</div>
</td>
<td class="px-5 py-3">
<p class="text-slate-700">${c.phone}</p>
<p class="text-[11px] text-slate-400">${c.email||'—'}</p>
</td>
<td class="px-5 py-3 text-slate-600">${c.nid||'—'}</td>
<td class="px-5 py-3 text-right font-semibold ${c.balance>0?'text-red-500':'text-slate-400'}">${c.balance>0?fmt(c.balance):'—'}</td>
<td class="px-5 py-3 text-center"><span class="inline-flex px-2 py-0.5 text-[10px] font-semibold rounded-full ${c.status==='Active'?'bg-emerald-50 text-emerald-700 ring-1 ring-emerald-600/20':'bg-slate-100 text-slate-500 ring-1 ring-slate-500/10'}">${c.status}</span></td>
<td class="px-5 py-3">
<div class="flex justify-end relative">
<button onclick="toggleMenu(${c.id})" class="p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg flex items-center gap-1 text-xs">
<span class="text-slate-500">Options</span>
<svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
</button>
<div id="menu-${c.id}" class="absolute right-0 top-8 z-20 bg-white border border-slate-200 rounded-lg shadow-lg py-1 min-w-[140px]" style="display:none">
<button onclick="viewProfile(${c.id});closeMenus()" class="w-full px-3 py-2 text-left text-xs text-slate-600 hover:bg-slate-50 flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>View Profile</button>
<button onclick="editCustomer(${c.id});closeMenus()" class="w-full px-3 py-2 text-left text-xs text-slate-600 hover:bg-slate-50 flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/></svg>Edit</button>
<div class="border-t border-slate-100 my-1"></div>
<button onclick="openDeleteModal(${c.id});closeMenus()" class="w-full px-3 py-2 text-left text-xs text-red-500 hover:bg-red-50 flex items-center gap-2"><svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>Delete</button>
</div>
</div>
</td>
</tr>
`).join('');
}

function changePage(dir){
currentPage+=dir;
renderTable();
}

function viewProfile(id){showToast('Opening profile #'+id+'...');}

function toggleMenu(id){
closeMenus();
document.getElementById('menu-'+id).style.display='block';
}

function closeMenus(){
document.querySelectorAll('[id^="menu-"]').forEach(m=>m.style.display='none');
}

document.addEventListener('click',function(e){
if(!e.target.closest('[onclick^="toggleMenu"]')&&!e.target.closest('[id^="menu-"]')){closeMenus();}
});

function openModal(){
editId=null;
document.getElementById('modalTitle').textContent='Add Customer';
document.getElementById('tabs').style.display='flex';
clearForm();
document.getElementById('modal').style.display='flex';
}

function closeModal(){document.getElementById('modal').style.display='none';clearForm();}

function clearForm(){
['inpName','inpEmail','inpPhone','inpPhone2','inpNid','inpAddress'].forEach(id=>document.getElementById(id).value='');
document.getElementById('inpStatus').value='Active';
document.getElementById('multiRows').innerHTML='';
addMultiRow();
switchTab('single');
}

function switchTab(tab){
currentTab=tab;
document.getElementById('tabSingle').className='px-6 py-3 text-sm border-b-2 -mb-px '+(tab==='single'?'font-semibold text-emerald-600 border-emerald-600 bg-white':'font-medium text-slate-500 border-transparent hover:text-slate-700');
document.getElementById('tabMulti').className='px-6 py-3 text-sm border-b-2 -mb-px '+(tab==='multi'?'font-semibold text-emerald-600 border-emerald-600 bg-white':'font-medium text-slate-500 border-transparent hover:text-slate-700');
document.getElementById('singleForm').style.display=tab==='single'?'block':'none';
document.getElementById('multiForm').style.display=tab==='multi'?'block':'none';
}

function addMultiRow(){
const div=document.createElement('div');
div.className='flex gap-2 items-start bg-slate-50 p-3 rounded-lg';
div.innerHTML=`<input type="text" placeholder="Name *" class="flex-1 px-3 py-2 border border-slate-200 rounded-lg text-sm"><input type="text" placeholder="Phone *" class="flex-1 px-3 py-2 border border-slate-200 rounded-lg text-sm"><input type="email" placeholder="Email" class="flex-1 px-3 py-2 border border-slate-200 rounded-lg text-sm"><input type="text" placeholder="NID" class="w-32 px-3 py-2 border border-slate-200 rounded-lg text-sm"><button onclick="this.parentElement.remove()" class="p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg"><svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg></button>`;
document.getElementById('multiRows').appendChild(div);
}

function editCustomer(id){
editId=id;
const c=customers.find(x=>x.id===id);
if(!c)return;
document.getElementById('modalTitle').textContent='Edit Customer';
document.getElementById('tabs').style.display='none';
document.getElementById('singleForm').style.display='block';
document.getElementById('multiForm').style.display='none';
document.getElementById('inpName').value=c.name;
document.getElementById('inpEmail').value=c.email||'';
document.getElementById('inpPhone').value=c.phone;
document.getElementById('inpPhone2').value=c.phone2||'';
document.getElementById('inpNid').value=c.nid||'';
document.getElementById('inpAddress').value=c.address||'';
document.getElementById('inpStatus').value=c.status;
document.getElementById('modal').style.display='flex';
}

function saveCustomer(){
if(currentTab==='single'||editId){
const name=document.getElementById('inpName').value.trim(),phone=document.getElementById('inpPhone').value.trim();
if(!name||!phone){alert('Name and Phone are required');return;}
const data={name,email:document.getElementById('inpEmail').value.trim(),phone,phone2:document.getElementById('inpPhone2').value.trim(),nid:document.getElementById('inpNid').value.trim(),address:document.getElementById('inpAddress').value.trim(),status:document.getElementById('inpStatus').value};
if(editId){Object.assign(customers.find(c=>c.id===editId),data);showToast('Customer updated successfully');}
else{customers.unshift({id:Date.now(),...data,balance:0,created:new Date()});showToast('Customer added successfully');}
}else{
const rows=document.getElementById('multiRows').children;
let added=0;
for(let r of rows){
const inputs=r.querySelectorAll('input');
const name=inputs[0].value.trim(),phone=inputs[1].value.trim(),email=inputs[2].value.trim(),nid=inputs[3].value.trim();
if(name&&phone){customers.unshift({id:Date.now()+added,name,phone,phone2:'',email,nid,address:'',status:'Active',balance:0,created:new Date()});added++;}
}
if(!added){alert('Add at least one valid customer');return;}
showToast(added+' customer(s) added successfully');
}
closeModal();updateStats();renderTable();
}

function openDeleteModal(id){deleteId=id;document.getElementById('deleteModal').style.display='flex';}
function closeDeleteModal(){deleteId=null;document.getElementById('deleteModal').style.display='none';}
function confirmDelete(){
customers=customers.filter(c=>c.id!==deleteId);
closeDeleteModal();updateStats();renderTable();
showToast('Customer deleted successfully');
}

function exportData(){showToast('Exporting customers...');}

addMultiRow();updateStats();renderTable();
</script>
</body>
</html>